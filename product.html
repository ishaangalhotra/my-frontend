<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Management - QuickLocal Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
  <style>
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .product-card {
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    
    .product-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      border-color: #3b82f6;
    }
    
    .animate-fade-in {
      animation: fadeIn 0.6s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .status-indicator {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    .table-row:hover {
      background-color: #f8fafc;
    }
    
    .image-upload-area {
      background: linear-gradient(45deg, #f0f9ff, #e0f2fe);
      border: 2px dashed #0ea5e9;
      transition: all 0.3s ease;
    }
    
    .image-upload-area:hover {
      background: linear-gradient(45deg, #e0f2fe, #bae6fd);
      border-color: #0284c7;
    }
    
    .stock-indicator-low {
      background: linear-gradient(135deg, #fef3c7, #fbbf24);
    }
    
    .stock-indicator-out {
      background: linear-gradient(135deg, #fee2e2, #ef4444);
    }
    
    .category-chip {
      background: linear-gradient(135deg, #ddd6fe, #8b5cf6);
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    
    /* Smooth transitions */
    .transition-all {
      transition-property: all;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 150ms;
    }
    
    /* Custom animations */
    @keyframes slideInRight {
      from {
        transform: translateX(20px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    .slide-in-right {
      animation: slideInRight 0.3s ease-out;
    }
    
    /* Tooltip styles */
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 120px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    /* Loading spinner */
    .spinner {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Enhanced Header with Responsive Design -->
  <header class="bg-white shadow-lg border-b border-gray-200 sticky top-0 z-10">
    <div class="flex flex-col md:flex-row items-start md:items-center justify-between px-4 py-3 md:px-6 md:py-4">
      <div class="flex items-center space-x-2 md:space-x-4 mb-3 md:mb-0">
        <a href="dashboard.html" class="text-blue-600 hover:text-blue-700 transition-colors text-sm md:text-base">
          <i class="fas fa-arrow-left mr-1 md:mr-2"></i>Back
        </a>
        <div class="h-4 md:h-6 w-px bg-gray-300"></div>
        <div>
          <h1 class="text-xl md:text-3xl font-bold text-gray-800">Product Management</h1>
          <p class="text-gray-600 text-xs md:text-sm">Manage your marketplace inventory</p>
        </div>
      </div>
      
      <div class="flex flex-col md:flex-row w-full md:w-auto space-y-2 md:space-y-0 md:space-x-4">
        <!-- Real-time Status -->
        <div class="bg-green-50 px-2 py-1 md:px-3 md:py-2 rounded-lg border border-green-200 self-start">
          <div class="flex items-center space-x-1 md:space-x-2">
            <div class="w-2 h-2 bg-green-500 rounded-full status-indicator"></div>
            <span class="text-green-700 text-xs md:text-sm font-medium">Live Sync</span>
          </div>
        </div>
        
        <!-- Search -->
        <div class="relative w-full md:w-auto">
          <input 
            type="text" 
            id="globalSearch"
            placeholder="Search products..." 
            class="pl-8 pr-3 py-2 md:pl-10 md:pr-4 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-full md:w-80 shadow-sm text-sm md:text-base"
          >
          <i class="fas fa-search absolute left-2 md:left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
        </div>
        
        <!-- Quick Actions -->
        <div class="flex items-center space-x-1 md:space-x-2 justify-end">
          <button 
            id="importBtn"
            class="bg-purple-600 text-white px-3 py-2 md:px-4 md:py-3 rounded-lg hover:bg-purple-700 transition-colors flex items-center shadow-sm text-sm md:text-base"
            title="Import Products"
          >
            <i class="fas fa-upload mr-1 md:mr-2"></i><span class="hidden md:inline">Import</span>
          </button>
          
          <button 
            id="exportBtn"
            class="bg-green-600 text-white px-3 py-2 md:px-4 md:py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center shadow-sm text-sm md:text-base"
            title="Export Products"
          >
            <i class="fas fa-download mr-1 md:mr-2"></i><span class="hidden md:inline">Export</span>
          </button>
          
          <button 
            id="addProductBtn"
            class="bg-blue-600 text-white px-3 py-2 md:px-4 md:py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center shadow-sm text-sm md:text-base"
            title="Add Product"
          >
            <i class="fas fa-plus mr-1 md:mr-2"></i><span class="hidden md:inline">Add</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="p-4 md:p-6">
    <!-- Enhanced Stats Cards with Loading State -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-6 md:mb-8">
      <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 animate-fade-in border-l-4 border-blue-500 relative overflow-hidden">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-500 text-xs md:text-sm mb-1 font-medium">Total Products</p>
            <p class="text-2xl md:text-3xl font-bold text-gray-800" id="totalProducts">
              <span class="loading-placeholder inline-block h-8 w-16 bg-gray-200 rounded animate-pulse"></span>
            </p>
            <div class="flex items-center mt-1 md:mt-2">
              <span class="loading-placeholder inline-block h-4 w-20 bg-gray-200 rounded animate-pulse"></span>
            </div>
          </div>
          <div class="bg-blue-100 p-3 md:p-4 rounded-full">
            <i class="fas fa-box text-blue-600 text-xl md:text-2xl"></i>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 animate-fade-in border-l-4 border-green-500 relative overflow-hidden" style="animation-delay: 0.1s">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-500 text-xs md:text-sm mb-1 font-medium">Active Products</p>
            <p class="text-2xl md:text-3xl font-bold text-gray-800" id="activeProducts">
              <span class="loading-placeholder inline-block h-8 w-16 bg-gray-200 rounded animate-pulse"></span>
            </p>
            <div class="flex items-center mt-1 md:mt-2">
              <span class="loading-placeholder inline-block h-4 w-20 bg-gray-200 rounded animate-pulse"></span>
            </div>
          </div>
          <div class="bg-green-100 p-3 md:p-4 rounded-full">
            <i class="fas fa-check-circle text-green-600 text-xl md:text-2xl"></i>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 animate-fade-in border-l-4 border-red-500 relative overflow-hidden" style="animation-delay: 0.2s">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-500 text-xs md:text-sm mb-1 font-medium">Out of Stock</p>
            <p class="text-2xl md:text-3xl font-bold text-gray-800" id="outOfStock">
              <span class="loading-placeholder inline-block h-8 w-16 bg-gray-200 rounded animate-pulse"></span>
            </p>
            <div class="flex items-center mt-1 md:mt-2">
              <span class="loading-placeholder inline-block h-4 w-20 bg-gray-200 rounded animate-pulse"></span>
            </div>
          </div>
          <div class="bg-red-100 p-3 md:p-4 rounded-full">
            <i class="fas fa-exclamation-triangle text-red-600 text-xl md:text-2xl"></i>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 animate-fade-in border-l-4 border-yellow-500 relative overflow-hidden" style="animation-delay: 0.3s">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-500 text-xs md:text-sm mb-1 font-medium">Low Stock</p>
            <p class="text-2xl md:text-3xl font-bold text-gray-800" id="lowStock">
              <span class="loading-placeholder inline-block h-8 w-16 bg-gray-200 rounded animate-pulse"></span>
            </p>
            <div class="flex items-center mt-1 md:mt-2">
              <span class="loading-placeholder inline-block h-4 w-20 bg-gray-200 rounded animate-pulse"></span>
            </div>
          </div>
          <div class="bg-yellow-100 p-3 md:p-4 rounded-full">
            <i class="fas fa-exclamation text-yellow-600 text-xl md:text-2xl"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Advanced Filters and Analytics -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6 mb-6 md:mb-8">
      <!-- Filters Panel -->
      <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-4 md:p-6">
        <div class="flex items-center justify-between mb-4 md:mb-6">
          <h3 class="text-lg md:text-xl font-semibold text-gray-800">Advanced Filters</h3>
          <button id="resetFilters" class="text-blue-600 hover:text-blue-700 text-xs md:text-sm font-medium">
            <i class="fas fa-undo mr-1"></i>Reset All
          </button>
        </div>
        
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4">
          <div>
            <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Category</label>
            <select id="categoryFilter" class="w-full border border-gray-300 rounded-lg px-2 md:px-3 py-1 md:py-2 focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
              <option value="">All Categories</option>
              <option value="fruits">üçé Fruits</option>
              <option value="vegetables">ü•ï Vegetables</option>
              <option value="dairy">ü•õ Dairy</option>
              <option value="bakery">üçû Bakery</option>
              <option value="groceries">üõí Groceries</option>
              <option value="meat">ü•© Meat & Seafood</option>
            </select>
          </div>
          
          <div>
            <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Status</label>
            <select id="statusFilter" class="w-full border border-gray-300 rounded-lg px-2 md:px-3 py-1 md:py-2 focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
              <option value="">All Status</option>
              <option value="active">‚úÖ Active</option>
              <option value="inactive">‚è∏Ô∏è Inactive</option>
              <option value="out_of_stock">‚ùå Out of Stock</option>
              <option value="low_stock">‚ö†Ô∏è Low Stock</option>
            </select>
          </div>
          
          <div>
            <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Price Range</label>
            <div class="flex space-x-1 md:space-x-2">
              <input type="number" id="minPrice" placeholder="Min ‚Çπ" class="w-full border border-gray-300 rounded-lg px-2 md:px-3 py-1 md:py-2 focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
              <input type="number" id="maxPrice" placeholder="Max ‚Çπ" class="w-full border border-gray-300 rounded-lg px-2 md:px-3 py-1 md:py-2 focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
            </div>
          </div>
          
          <div>
            <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Seller</label>
            <select id="sellerFilter" class="w-full border border-gray-300 rounded-lg px-2 md:px-3 py-1 md:py-2 focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
              <option value="">All Sellers</option>
              <option value="seller1">Fresh Fruits Store</option>
              <option value="seller2">Local Bakery</option>
              <option value="seller3">Vegetable Market</option>
              <option value="seller4">Dairy Farm</option>
            </select>
          </div>
        </div>
        
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between mt-4 md:mt-6 pt-3 md:pt-4 border-t border-gray-200 space-y-2 md:space-y-0">
          <div class="flex items-center space-x-2 md:space-x-4">
            <button id="applyFilters" class="bg-blue-600 text-white px-3 md:px-4 py-1 md:py-2 rounded-lg hover:bg-blue-700 transition-colors text-xs md:text-sm">
              <i class="fas fa-filter mr-1 md:mr-2"></i>Apply Filters
            </button>
            <span id="filterResults" class="text-xs md:text-sm text-gray-600">Loading products...</span>
          </div>
          
          <div class="flex items-center space-x-1 md:space-x-2">
            <label class="text-xs md:text-sm text-gray-500">Sort by:</label>
            <select id="sortBy" class="border border-gray-300 rounded px-2 md:px-3 py-1 text-xs md:text-sm focus:ring-2 focus:ring-blue-500">
              <option value="name">Name</option>
              <option value="price">Price</option>
              <option value="stock">Stock</option>
              <option value="created">Date Added</option>
              <option value="sales">Sales Volume</option>
            </select>
          </div>
        </div>
      </div>
      
      <!-- Quick Analytics -->
      <div class="bg-white rounded-xl shadow-lg p-4 md:p-6">
        <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4">Category Distribution</h3>
        <div class="relative h-40 md:h-48">
          <canvas id="categoryChart" width="300" height="200"></canvas>
          <div class="absolute inset-0 flex items-center justify-center" id="chartLoading">
            <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
          </div>
        </div>
        
        <div class="mt-4 md:mt-6 space-y-2 md:space-y-3">
          <div class="flex items-center justify-between text-xs md:text-sm">
            <span class="text-gray-600">Top Category:</span>
            <span class="font-medium text-gray-900" id="topCategory">Loading...</span>
          </div>
          <div class="flex items-center justify-between text-xs md:text-sm">
            <span class="text-gray-600">Fastest Growing:</span>
            <span class="font-medium text-green-600" id="fastestGrowing">Loading...</span>
          </div>
          <div class="flex items-center justify-between text-xs md:text-sm">
            <span class="text-gray-600">Needs Attention:</span>
            <span class="font-medium text-red-600" id="needsAttention">Loading...</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Products Table with Loading State -->
    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
      <div class="px-4 md:px-6 py-3 md:py-4 border-b border-gray-200 bg-gray-50">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between space-y-2 md:space-y-0">
          <div class="flex items-center space-x-2 md:space-x-4">
            <h3 class="text-base md:text-lg font-semibold text-gray-800">Products Inventory</h3>
            <span class="bg-blue-100 text-blue-800 text-xs md:text-sm px-2 md:px-3 py-0.5 md:py-1 rounded-full font-medium">
              <span id="totalCount">0</span> items
            </span>
          </div>
          
          <div class="flex items-center space-x-1 md:space-x-3">
            <div class="flex items-center space-x-1 md:space-x-2">
              <input type="checkbox" id="selectAll" class="rounded text-xs md:text-sm">
              <label for="selectAll" class="text-xs md:text-sm text-gray-600">Select All</label>
            </div>
            
            <button id="bulkActions" class="bg-purple-600 text-white px-3 md:px-4 py-1 md:py-2 rounded-lg hover:bg-purple-700 transition-colors text-xs md:text-sm">
              <i class="fas fa-tasks mr-1 md:mr-2"></i>Bulk Actions
            </button>
            
            <div class="flex items-center space-x-1 md:space-x-2">
              <span class="text-xs md:text-sm text-gray-500">Show:</span>
              <select id="itemsPerPage" class="border border-gray-300 rounded px-1 md:px-2 py-1 text-xs md:text-sm">
                <option value="10">10</option>
                <option value="25" selected>25</option>
                <option value="50">50</option>
                <option value="100">100</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      
      <div class="overflow-x-auto relative">
        <table class="w-full">
          <thead class="bg-gray-50 border-b border-gray-200">
            <tr>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                <input type="checkbox" id="selectAllHeader" class="rounded">
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" data-sort="name">
                Product
                <i class="fas fa-sort ml-1 text-gray-400"></i>
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" data-sort="category">
                Category
                <i class="fas fa-sort ml-1 text-gray-400"></i>
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" data-sort="price">
                Price
                <i class="fas fa-sort ml-1 text-gray-400"></i>
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" data-sort="stock">
                Stock
                <i class="fas fa-sort ml-1 text-gray-400"></i>
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Seller
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Performance
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Status
              </th>
              <th class="px-4 md:px-6 py-2 md:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Actions
              </th>
            </tr>
          </thead>
          <tbody id="productsTableBody" class="bg-white divide-y divide-gray-200">
            <!-- Loading state -->
            <tr id="loadingRow" class="animate-pulse">
              <td colspan="9" class="px-6 py-12 text-center">
                <div class="flex flex-col items-center justify-center space-y-2">
                  <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
                  <p class="text-gray-600">Loading products...</p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- Enhanced Pagination -->
      <div class="px-4 md:px-6 py-3 md:py-4 bg-gray-50 border-t border-gray-200">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between space-y-2 md:space-y-0">
          <div class="flex items-center space-x-2 md:space-x-4">
            <span class="text-xs md:text-sm text-gray-700">
              Showing <span id="showingFrom" class="font-medium">0</span> to <span id="showingTo" class="font-medium">0</span> of <span id="totalItems" class="font-medium">0</span> results
            </span>
            <div class="flex items-center space-x-1 md:space-x-2">
              <button id="prevPage" class="px-2 md:px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50" disabled>
                <i class="fas fa-chevron-left"></i>
              </button>
              <div id="pageNumbers" class="flex items-center space-x-1">
                <!-- Dynamic page numbers -->
              </div>
              <button id="nextPage" class="px-2 md:px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50" disabled>
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
          
          <div class="flex items-center space-x-1 md:space-x-2">
            <span class="text-xs md:text-sm text-gray-500">Jump to page:</span>
            <input type="number" id="jumpToPage" min="1" class="w-12 md:w-16 px-1 md:px-2 py-1 border border-gray-300 rounded text-xs md:text-sm">
            <button id="jumpButton" class="px-2 md:px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-xs md:text-sm">Go</button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Enhanced Add/Edit Product Modal -->
  <div id="productModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50 transition-opacity duration-300">
    <div class="bg-white rounded-2xl max-w-4xl w-full mx-2 md:mx-4 max-h-[90vh] overflow-y-auto transform transition-all duration-300 scale-95 opacity-0" id="modalContent">
      <div class="sticky top-0 bg-white border-b border-gray-200 px-6 md:px-8 py-4 md:py-6 rounded-t-2xl z-10">
        <div class="flex items-center justify-between">
          <h2 id="modalTitle" class="text-xl md:text-2xl font-bold text-gray-800">Add New Product</h2>
          <button id="closeModal" class="text-gray-400 hover:text-gray-600 transition-colors">
            <i class="fas fa-times text-lg md:text-xl"></i>
          </button>
        </div>
      </div>
      
      <form id="productForm" class="p-4 md:p-8 space-y-6 md:space-y-8">
        <!-- Product Images Section -->
        <div>
          <h3 class="text-base md:text-lg font-semibold text-gray-800 mb-3 md:mb-4">Product Images</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
            <!-- Main Image Upload -->
            <div>
              <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Main Product Image *</label>
              <div class="image-upload-area rounded-lg p-4 md:p-8 text-center cursor-pointer" id="mainImageUpload">
                <input type="file" id="mainImageInput" accept="image/*" class="hidden">
                <div id="mainImagePreview" class="hidden">
                  <img id="mainImageDisplay" class="max-w-full h-32 md:h-48 object-cover rounded-lg mx-auto">
                  <button type="button" id="removeMainImage" class="mt-1 md:mt-2 text-red-600 hover:text-red-700 text-xs md:text-sm">
                    <i class="fas fa-trash mr-1"></i>Remove
                  </button>
                </div>
                <div id="mainImagePlaceholder">
                  <i class="fas fa-cloud-upload-alt text-3xl md:text-4xl text-blue-500 mb-2 md:mb-3"></i>
                  <p class="text-gray-600 font-medium text-xs md:text-sm">Click to upload main image</p>
                  <p class="text-gray-400 text-xs mt-1">PNG, JPG up to 5MB</p>
                </div>
              </div>
            </div>
            
            <!-- Additional Images -->
            <div>
              <label class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Additional Images (Optional)</label>
              <div class="space-y-2 md:space-y-3">
                <div class="image-upload-area rounded-lg p-3 md:p-4 text-center cursor-pointer" id="additionalImageUpload">
                  <input type="file" id="additionalImageInput" accept="image/*" multiple class="hidden">
                  <i class="fas fa-plus text-xl md:text-2xl text-blue-500 mb-1 md:mb-2"></i>
                  <p class="text-gray-600 text-xs md:text-sm">Add more images</p>
                </div>
                <div id="additionalImagesPreview" class="grid grid-cols-3 gap-1 md:gap-2">
                  <!-- Additional image previews will appear here -->
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Basic Information -->
        <div>
          <h3 class="text-base md:text-lg font-semibold text-gray-800 mb-3 md:mb-4">Basic Information</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
            <div>
              <label for="productName" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Product Name *</label>
              <input type="text" id="productName" required class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="Enter product name">
            </div>
            
            <div>
              <label for="productSKU" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">SKU *</label>
              <div class="flex items-center space-x-2">
                <input type="text" id="productSKU" required class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="Auto-generated">
                <button type="button" id="generateSKUBtn" class="px-3 py-2 md:py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-xs md:text-sm" title="Generate SKU">
                  <i class="fas fa-sync-alt"></i>
                </button>
              </div>
            </div>
            
            <div>
              <label for="productCategory" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Category *</label>
              <select id="productCategory" required class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
                <option value="">Select Category</option>
                <option value="fruits">üçé Fruits</option>
                <option value="vegetables">ü•ï Vegetables</option>
                <option value="dairy">ü•õ Dairy</option>
                <option value="bakery">üçû Bakery</option>
                <option value="groceries">üõí Groceries</option>
                <option value="meat">ü•© Meat & Seafood</option>
              </select>
            </div>
            
            <div>
              <label for="productBrand" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Brand</label>
              <input type="text" id="productBrand" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="Enter brand name">
            </div>
          </div>
          
          <div class="mt-4 md:mt-6">
            <label for="productDescription" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Description *</label>
            <textarea id="productDescription" rows="4" required class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="Describe your product in detail..."></textarea>
          </div>
        </div>
        
        <!-- Pricing & Inventory -->
        <div>
          <h3 class="text-base md:text-lg font-semibold text-gray-800 mb-3 md:mb-4">Pricing & Inventory</h3>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
            <div>
              <label for="productPrice" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Price (‚Çπ) *</label>
              <input type="number" id="productPrice" required min="0" step="0.01" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="0.00">
            </div>
            
            <div>
              <label for="productComparePrice" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Compare at Price (‚Çπ)</label>
              <input type="number" id="productComparePrice" min="0" step="0.01" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="0.00">
            </div>
            
            <div>
              <label for="productCostPrice" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Cost per Item (‚Çπ)</label>
              <input type="number" id="productCostPrice" min="0" step="0.01" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="0.00">
            </div>
            
            <div>
              <label for="productStock" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Stock Quantity *</label>
              <input type="number" id="productStock" required min="0" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="0">
            </div>
            
            <div>
              <label for="productLowStockThreshold" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Low Stock Alert</label>
              <input type="number" id="productLowStockThreshold" min="0" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="10">
            </div>
            
            <div>
              <label for="productUnit" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Unit</label>
              <select id="productUnit" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
                <option value="piece">Piece</option>
                <option value="kg">Kilogram</option>
                <option value="gram">Gram</option>
                <option value="liter">Liter</option>
                <option value="ml">Milliliter</option>
                <option value="packet">Packet</option>
                <option value="box">Box</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Seller & Status -->
        <div>
          <h3 class="text-base md:text-lg font-semibold text-gray-800 mb-3 md:mb-4">Seller & Status</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
            <div>
              <label for="productSeller" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Seller *</label>
              <select id="productSeller" required class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
                <option value="">Select Seller</option>
                <option value="seller1">Fresh Fruits Store</option>
                <option value="seller2">Local Bakery</option>
                <option value="seller3">Vegetable Market</option>
                <option value="seller4">Dairy Farm</option>
              </select>
            </div>
            
            <div>
              <label for="productStatus" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Status *</label>
              <select id="productStatus" required class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm">
                <option value="active">‚úÖ Active</option>
                <option value="inactive">‚è∏Ô∏è Inactive</option>
                <option value="draft">üìù Draft</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Advanced Options -->
        <div>
          <h3 class="text-base md:text-lg font-semibold text-gray-800 mb-3 md:mb-4">Advanced Options</h3>
          <div class="space-y-3 md:space-y-4">
            <div class="flex flex-wrap items-center gap-3 md:gap-4">
              <label class="flex items-center space-x-1 md:space-x-2">
                <input type="checkbox" id="trackQuantity" class="rounded" checked>
                <span class="text-xs md:text-sm text-gray-700">Track quantity</span>
              </label>
              
              <label class="flex items-center space-x-1 md:space-x-2">
                <input type="checkbox" id="allowBackorders" class="rounded">
                <span class="text-xs md:text-sm text-gray-700">Allow backorders</span>
              </label>
              
              <label class="flex items-center space-x-1 md:space-x-2">
                <input type="checkbox" id="featured" class="rounded">
                <span class="text-xs md:text-sm text-gray-700">Featured product</span>
              </label>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
              <div>
                <label for="productTags" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Tags</label>
                <input type="text" id="productTags" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="Enter tags separated by commas">
              </div>
              
              <div>
                <label for="productWeight" class="block text-xs md:text-sm font-medium text-gray-700 mb-1 md:mb-2">Weight (grams)</label>
                <input type="number" id="productWeight" min="0" class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs md:text-sm" placeholder="0">
              </div>
            </div>
          </div>
        </div>
        
        <!-- Form Actions -->
        <div class="flex flex-col md:flex-row justify-end space-y-2 md:space-y-0 md:space-x-3 pt-4 md:pt-6 border-t border-gray-200">
          <button type="button" id="cancelBtn" class="px-4 md:px-6 py-2 md:py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium text-xs md:text-sm">
            Cancel
          </button>
          <button type="button" id="saveDraftBtn" class="px-4 md:px-6 py-2 md:py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium text-xs md:text-sm">
            <i class="fas fa-save mr-1 md:mr-2"></i>Save as Draft
          </button>
          <button type="submit" class="px-4 md:px-6 py-2 md:py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-xs md:text-sm">
            <i class="fas fa-check mr-1 md:mr-2"></i>Save Product
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Bulk Actions Dropdown -->
  <div id="bulkActionsDropdown" class="hidden fixed right-4 top-20 md:top-24 bg-white rounded-lg shadow-xl z-50 w-48 border border-gray-200">
    <div class="py-1">
      <button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center" onclick="productManager.performBulkAction('activate')">
        <i class="fas fa-check-circle mr-2 text-green-500"></i> Activate
      </button>
      <button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center" onclick="productManager.performBulkAction('deactivate')">
        <i class="fas fa-pause-circle mr-2 text-yellow-500"></i> Deactivate
      </button>
      <button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center" onclick="productManager.performBulkAction('delete')">
        <i class="fas fa-trash mr-2 text-red-500"></i> Delete
      </button>
      <div class="border-t border-gray-200"></div>
      <button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center" onclick="productManager.showCategoryUpdateModal()">
        <i class="fas fa-tags mr-2 text-purple-500"></i> Update Category
      </button>
    </div>
  </div>

  <!-- Update Category Modal -->
  <div id="updateCategoryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg p-6 max-w-sm w-full">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold">Update Category</h3>
        <button onclick="productManager.closeCategoryUpdateModal()" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-2">Select Category</label>
        <select id="bulkCategorySelect" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
          <option value="fruits">üçé Fruits</option>
          <option value="vegetables">ü•ï Vegetables</option>
          <option value="dairy">ü•õ Dairy</option>
          <option value="bakery">üçû Bakery</option>
          <option value="groceries">üõí Groceries</option>
          <option value="meat">ü•© Meat & Seafood</option>
        </select>
      </div>
      <div class="flex justify-end space-x-3">
        <button onclick="productManager.closeCategoryUpdateModal()" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
          Cancel
        </button>
        <button onclick="productManager.updateBulkCategory()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
          Update
        </button>
      </div>
    </div>
  </div>

  <!-- Enhanced JavaScript -->
  <script>
    class ProductManager {
      constructor() {
        this.products = [];
        this.filteredProducts = [];
        this.currentPage = 1;
        this.itemsPerPage = 25;
        this.filters = {};
        this.sortBy = 'name';
        this.sortOrder = 'asc';
        this.editingProduct = null;
        this.selectedProducts = [];
        
        this.init();
      }
      
      init() {
        this.setupEventListeners();
        this.generateMockData();
        this.initializeChart();
        this.renderProducts();
        this.updateStats();
      }
      
      setupEventListeners() {
        // Search
        document.getElementById('globalSearch').addEventListener('input', (e) => {
          this.debounce(this.handleSearch.bind(this), 500)(e.target.value);
        });
        
        // Filters
        ['categoryFilter', 'statusFilter', 'sellerFilter'].forEach(id => {
          document.getElementById(id).addEventListener('change', () => {
            this.applyFilters();
          });
        });
        
        // Price range
        ['minPrice', 'maxPrice'].forEach(id => {
          document.getElementById(id).addEventListener('input', 
            this.debounce(() => this.applyFilters(), 500)
          );
        });
        
        // Sorting
        document.querySelectorAll('[data-sort]').forEach(th => {
          th.addEventListener('click', () => {
            const sortField = th.getAttribute('data-sort');
            this.sortProducts(sortField);
          });
        });
        
        // Modal controls
        document.getElementById('addProductBtn').addEventListener('click', () => {
          this.openProductModal();
        });
        
        document.getElementById('closeModal').addEventListener('click', () => {
          this.closeProductModal();
        });
        
        document.getElementById('cancelBtn').addEventListener('click', () => {
          this.closeProductModal();
        });
        
        // Form submission
        document.getElementById('productForm').addEventListener('submit', (e) => {
          e.preventDefault();
          this.saveProduct();
        });
        
        // Save draft
        document.getElementById('saveDraftBtn').addEventListener('click', () => {
          this.saveProductAsDraft();
        });
        
        // Generate SKU
        document.getElementById('generateSKUBtn').addEventListener('click', () => {
          this.generateSKU();
        });
        
        // Image uploads
        this.setupImageUpload();
        
        // Pagination
        this.setupPagination();
        
        // Bulk actions
        document.getElementById('bulkActions').addEventListener('click', (e) => {
          this.toggleBulkActionsDropdown(e);
        });
        
        // Select all checkbox
        document.getElementById('selectAllHeader').addEventListener('change', (e) => {
          const checkboxes = document.querySelectorAll('.product-checkbox');
          checkboxes.forEach(cb => cb.checked = e.target.checked);
          this.updateSelectedProducts();
        });
        
        // Reset filters
        document.getElementById('resetFilters').addEventListener('click', () => {
          this.resetFilters();
        });
        
        // Items per page
        document.getElementById('itemsPerPage').addEventListener('change', (e) => {
          this.itemsPerPage = parseInt(e.target.value);
          this.currentPage = 1;
          this.renderProducts();
        });
        
        // Close bulk actions when clicking outside
        document.addEventListener('click', (e) => {
          if (!e.target.closest('#bulkActions') && !e.target.closest('#bulkActionsDropdown')) {
            document.getElementById('bulkActionsDropdown').classList.add('hidden');
          }
        });
      }
      
      setupImageUpload() {
        // Main image upload
        const mainImageUpload = document.getElementById('mainImageUpload');
        const mainImageInput = document.getElementById('mainImageInput');
        
        mainImageUpload.addEventListener('click', () => {
          mainImageInput.click();
        });
        
        mainImageInput.addEventListener('change', (e) => {
          this.handleMainImageUpload(e.target.files[0]);
        });
        
        // Additional images upload
        const additionalImageUpload = document.getElementById('additionalImageUpload');
        const additionalImageInput = document.getElementById('additionalImageInput');
        
        additionalImageUpload.addEventListener('click', () => {
          additionalImageInput.click();
        });
        
        additionalImageInput.addEventListener('change', (e) => {
          this.handleAdditionalImagesUpload(e.target.files);
        });
      }
      
      handleMainImageUpload(file) {
        if (!file) return;
        
        // Validate file type and size
        const validTypes = ['image/jpeg', 'image/png', 'image/gif'];
        const maxSize = 5 * 1024 * 1024; // 5MB
        
        if (!validTypes.includes(file.type)) {
          this.showNotification('Please upload a valid image (JPEG, PNG, GIF)', 'error');
          return;
        }
        
        if (file.size > maxSize) {
          this.showNotification('Image size should be less than 5MB', 'error');
          return;
        }
        
        const reader = new FileReader();
        reader.onload = (e) => {
          const preview = document.getElementById('mainImagePreview');
          const placeholder = document.getElementById('mainImagePlaceholder');
          const display = document.getElementById('mainImageDisplay');
          
          display.src = e.target.result;
          preview.classList.remove('hidden');
          placeholder.classList.add('hidden');
        };
        reader.readAsDataURL(file);
        
        // Remove image functionality
        document.getElementById('removeMainImage').addEventListener('click', () => {
          this.removeMainImage();
        });
      }
      
      removeMainImage() {
        const preview = document.getElementById('mainImagePreview');
        const placeholder = document.getElementById('mainImagePlaceholder');
        const input = document.getElementById('mainImageInput');
        
        preview.classList.add('hidden');
        placeholder.classList.remove('hidden');
        input.value = '';
      }
      
      handleAdditionalImagesUpload(files) {
        if (!files || files.length === 0) return;
        
        const previewContainer = document.getElementById('additionalImagesPreview');
        
        // Clear existing previews
        previewContainer.innerHTML = '';
        
        // Limit to 5 additional images
        const maxImages = 5;
        const filesToProcess = Array.from(files).slice(0, maxImages);
        
        filesToProcess.forEach((file, index) => {
          const validTypes = ['image/jpeg', 'image/png', 'image/gif'];
          const maxSize = 5 * 1024 * 1024; // 5MB
          
          if (!validTypes.includes(file.type)) {
            this.showNotification(`Image ${index + 1} is not a valid type (JPEG, PNG, GIF)`, 'error');
            return;
          }
          
          if (file.size > maxSize) {
            this.showNotification(`Image ${index + 1} exceeds 5MB limit`, 'error');
            return;
          }
          
          const reader = new FileReader();
          reader.onload = (e) => {
            const previewItem = document.createElement('div');
            previewItem.className = 'relative group';
            previewItem.innerHTML = `
              <img src="${e.target.result}" class="w-full h-20 object-cover rounded-lg">
              <button class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity" onclick="this.parentElement.remove()">
                <i class="fas fa-times text-xs"></i>
              </button>
            `;
            previewContainer.appendChild(previewItem);
          };
          reader.readAsDataURL(file);
        });
      }
      
      generateMockData() {
        const categories = ['fruits', 'vegetables', 'dairy', 'bakery', 'groceries', 'meat'];
        const sellers = [
          { id: 'seller1', name: 'Fresh Fruits Store' },
          { id: 'seller2', name: 'Local Bakery' },
          { id: 'seller3', name: 'Vegetable Market' },
          { id: 'seller4', name: 'Dairy Farm' }
        ];
        
        const productNames = {
          fruits: ['Fresh Apples', 'Ripe Bananas', 'Sweet Oranges', 'Fresh Grapes', 'Juicy Mangoes'],
          vegetables: ['Fresh Tomatoes', 'Green Onions', 'Fresh Carrots', 'Leafy Spinach', 'Bell Peppers'],
          dairy: ['Fresh Milk', 'Greek Yogurt', 'Farm Cheese', 'Fresh Butter', 'Cottage Cheese'],
          bakery: ['Fresh Bread', 'Croissants', 'Chocolate Cake', 'Cookies', 'Muffins'],
          groceries: ['Rice Pack', 'Cooking Oil', 'Spice Mix', 'Pasta', 'Breakfast Cereal'],
          meat: ['Chicken Breast', 'Fresh Fish', 'Mutton Curry Cut', 'Eggs', 'Prawns']
        };
        
        this.products = [];
        
        // Generate more realistic data with trends
        for (let i = 1; i <= 2847; i++) {
          const category = categories[Math.floor(Math.random() * categories.length)];
          const seller = sellers[Math.floor(Math.random() * sellers.length)];
          const names = productNames[category];
          const name = names[Math.floor(Math.random() * names.length)];
          
          // Base price with some variation
          let price = 0;
          switch(category) {
            case 'fruits': price = Math.floor(Math.random() * 200) + 50; break;
            case 'vegetables': price = Math.floor(Math.random() * 150) + 30; break;
            case 'dairy': price = Math.floor(Math.random() * 300) + 40; break;
            case 'bakery': price = Math.floor(Math.random() * 250) + 20; break;
            case 'groceries': price = Math.floor(Math.random() * 500) + 100; break;
            case 'meat': price = Math.floor(Math.random() * 800) + 200; break;
          }
          
          // Stock with some items more likely to be low/out
          let stock = Math.floor(Math.random() * 100);
          if (Math.random() > 0.7) stock = Math.floor(Math.random() * 10); // 30% chance of low stock
          if (Math.random() > 0.9) stock = 0; // 10% chance of out of stock
          
          let status = 'active';
          if (stock === 0) status = 'out_of_stock';
          else if (stock < 10) status = 'low_stock';
          
          // Sales volume based on category
          let sales = Math.floor(Math.random() * 500);
          if (category === 'fruits' || category === 'vegetables') sales += 200; // More popular
          if (category === 'meat') sales = Math.floor(Math.random() * 200); // Less popular
          
          // Rating with some variation
          let rating = (Math.random() * 1.5 + 3.5).toFixed(1); // 3.5-5.0 range
          
          this.products.push({
            id: `PRD-${String(i).padStart(4, '0')}`,
            name: `${name} - Premium Quality`,
            category,
            price,
            comparePrice: price + Math.floor(Math.random() * 100),
            stock,
            seller: seller.name,
            sellerId: seller.id,
            status,
            description: `High quality ${name.toLowerCase()} sourced directly from local farms. Fresh, organic, and delivered within 20 minutes.`,
            image: `https://picsum.photos/400/300?random=${i}`,
            sku: `SKU-${category.toUpperCase().slice(0,3)}-${String(i).padStart(4, '0')}`,
            unit: category === 'dairy' ? 'liter' : category === 'meat' ? 'kg' : 'piece',
            featured: Math.random() > 0.8,
            rating,
            sales,
            createdAt: new Date(Date.now() - Math.random() * 180 * 24 * 60 * 60 * 1000) // Up to 180 days ago
          });
        }
        
        this.filteredProducts = [...this.products];
      }
      
      initializeChart() {
        const ctx = document.getElementById('categoryChart').getContext('2d');
        
        // Calculate category distribution
        const categoryCount = this.products.reduce((acc, product) => {
          acc[product.category] = (acc[product.category] || 0) + 1;
          return acc;
        }, {});
        
        // Find top, fastest growing, and needs attention categories
        const totalProducts = this.products.length;
        let topCategory = { name: '', count: 0 };
        let fastestGrowing = { name: '', growth: 0 };
        let needsAttention = { name: '', decline: 0 };
        
        for (const [category, count] of Object.entries(categoryCount)) {
          // Determine top category
          if (count > topCategory.count) {
            topCategory = { name: category, count };
          }
          
          // Simulate growth/decline (in a real app, this would come from historical data)
          const growth = (Math.random() * 50) - 10; // -10% to +40%
          if (growth > fastestGrowing.growth) {
            fastestGrowing = { name: category, growth: Math.round(growth) };
          }
          if (growth < needsAttention.decline) {
            needsAttention = { name: category, decline: Math.round(growth) };
          }
        }
        
        // Update chart info
        document.getElementById('topCategory').textContent = `${this.formatCategoryName(topCategory.name)} (${Math.round((topCategory.count / totalProducts) * 100)}%)`;
        document.getElementById('fastestGrowing').textContent = `${this.formatCategoryName(fastestGrowing.name)} (+${fastestGrowing.growth}%)`;
        document.getElementById('needsAttention').textContent = `${this.formatCategoryName(needsAttention.name)} (${needsAttention.decline}%)`;
        
        // Create chart
        this.categoryChart = new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: Object.keys(categoryCount).map(cat => this.formatCategoryName(cat)),
            datasets: [{
              data: Object.values(categoryCount),
              backgroundColor: [
                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'
              ],
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'bottom',
                labels: {
                  usePointStyle: true,
                  padding: 15,
                  font: { size: 11 }
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const label = context.label || '';
                    const value = context.raw || 0;
                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                    const percentage = Math.round((value / total) * 100);
                    return `${label}: ${value} (${percentage}%)`;
                  }
                }
              }
            }
          }
        });
        
        // Hide loading spinner
        document.getElementById('chartLoading').style.display = 'none';
      }
      
      formatCategoryName(category) {
        const names = {
          fruits: 'Fruits',
          vegetables: 'Vegetables',
          dairy: 'Dairy',
          bakery: 'Bakery',
          groceries: 'Groceries',
          meat: 'Meat & Seafood'
        };
        return names[category] || category;
      }
      
      renderProducts() {
        const tbody = document.getElementById('productsTableBody');
        const startIndex = (this.currentPage - 1) * this.itemsPerPage;
        const endIndex = startIndex + this.itemsPerPage;
        const paginatedProducts = this.filteredProducts.slice(startIndex, endIndex);
        
        // Sort products
        this.sortProducts(this.sortBy, this.sortOrder);
        
        // Hide loading row
        document.getElementById('loadingRow').style.display = 'none';
        
        // Clear existing rows
        tbody.innerHTML = '';
        
        if (paginatedProducts.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="9" class="px-6 py-8 text-center">
                <div class="flex flex-col items-center justify-center space-y-3">
                  <i class="fas fa-box-open text-4xl text-gray-400"></i>
                  <p class="text-gray-600 font-medium">No products found</p>
                  <p class="text-gray-500 text-sm">Try adjusting your filters or add a new product</p>
                  <button onclick="productManager.openProductModal()" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    <i class="fas fa-plus mr-2"></i>Add Product
                  </button>
                </div>
              </td>
            </tr>
          `;
          return;
        }
        
        // Add product rows
        paginatedProducts.forEach(product => {
          const row = document.createElement('tr');
          row.className = 'table-row hover:bg-gray-50 transition-colors';
          row.innerHTML = `
            <td class="px-4 md:px-6 py-3 md:py-4">
              <input type="checkbox" class="product-checkbox rounded" value="${product.id}" onchange="productManager.updateSelectedProducts()">
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              <div class="flex items-center">
                <img src="${product.image}" alt="${product.name}" class="w-12 md:w-16 h-12 md:h-16 rounded-lg object-cover mr-3 md:mr-4 shadow-sm">
                <div>
                  <div class="font-semibold text-gray-900 text-xs md:text-sm">${product.name}</div>
                  <div class="text-gray-500 text-xs">${product.sku}</div>
                  ${product.featured ? '<span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mt-1">‚≠ê Featured</span>' : ''}
                </div>
              </div>
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              <span class="category-chip inline-flex items-center px-2 md:px-3 py-0.5 md:py-1 rounded-full text-xs font-medium text-white">
                ${this.getCategoryIcon(product.category)} ${this.formatCategoryName(product.category)}
              </span>
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              <div class="text-sm font-semibold text-gray-900">‚Çπ${product.price.toFixed(2)}</div>
              ${product.comparePrice ? `<div class="text-gray-500 text-xs line-through">‚Çπ${product.comparePrice.toFixed(2)}</div>` : ''}
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              <div class="flex items-center">
                <span class="text-sm font-medium text-gray-900 mr-2">${product.stock}</span>
                ${this.getStockIndicator(product.stock)}
              </div>
              <div class="text-gray-500 text-xs mt-1">${product.unit}</div>
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              <div class="text-sm font-medium text-gray-900">${product.seller}</div>
              <div class="text-gray-500 text-xs">ID: ${product.sellerId}</div>
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              <div class="flex items-center space-x-2">
                <div class="flex items-center">
                  <span class="text-yellow-400 mr-1">‚≠ê</span>
                  <span class="font-medium text-sm">${product.rating}</span>
                </div>
                <div class="text-gray-500 text-xs">${product.sales} sales</div>
              </div>
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              ${this.getStatusBadge(product.status)}
            </td>
            <td class="px-4 md:px-6 py-3 md:py-4">
              <div class="flex items-center space-x-1 md:space-x-2">
                <button onclick="productManager.viewProduct('${product.id}')" class="text-blue-600 hover:text-blue-900 transition-colors tooltip" title="View">
                  <i class="fas fa-eye"></i>
                  <span class="tooltip-text">View Details</span>
                </button>
                <button onclick="productManager.editProduct('${product.id}')" class="text-green-600 hover:text-green-900 transition-colors tooltip" title="Edit">
                  <i class="fas fa-edit"></i>
                  <span class="tooltip-text">Edit</span>
                </button>
                <button onclick="productManager.duplicateProduct('${product.id}')" class="text-purple-600 hover:text-purple-900 transition-colors tooltip" title="Duplicate">
                  <i class="fas fa-copy"></i>
                  <span class="tooltip-text">Duplicate</span>
                </button>
                <button onclick="productManager.deleteProduct('${product.id}')" class="text-red-600 hover:text-red-900 transition-colors tooltip" title="Delete">
                  <i class="fas fa-trash"></i>
                  <span class="tooltip-text">Delete</span>
                </button>
              </div>
            </td>
          `;
          tbody.appendChild(row);
        });
        
        this.updatePagination();
      }
      
      sortProducts(field, order = null) {
        // Toggle sort order if sorting the same field
        if (field === this.sortBy) {
          this.sortOrder = order || (this.sortOrder === 'asc' ? 'desc' : 'asc');
        } else {
          this.sortBy = field;
          this.sortOrder = 'asc';
        }
        
        // Update sort indicators
        document.querySelectorAll('[data-sort]').forEach(th => {
          const icon = th.querySelector('i');
          if (th.getAttribute('data-sort') === field) {
            icon.className = this.sortOrder === 'asc' ? 'fas fa-sort-up ml-1' : 'fas fa-sort-down ml-1';
          } else {
            icon.className = 'fas fa-sort ml-1 text-gray-400';
          }
        });
        
        // Sort the products
        this.filteredProducts.sort((a, b) => {
          let valueA, valueB;
          
          switch(field) {
            case 'name':
              valueA = a.name.toLowerCase();
              valueB = b.name.toLowerCase();
              break;
            case 'category':
              valueA = a.category;
              valueB = b.category;
              break;
            case 'price':
              valueA = a.price;
              valueB = b.price;
              break;
            case 'stock':
              valueA = a.stock;
              valueB = b.stock;
              break;
            case 'created':
              valueA = a.createdAt;
              valueB = b.createdAt;
              break;
            case 'sales':
              valueA = a.sales;
              valueB = b.sales;
              break;
            default:
              valueA = a.name.toLowerCase();
              valueB = b.name.toLowerCase();
          }
          
          if (valueA < valueB) return this.sortOrder === 'asc' ? -1 : 1;
          if (valueA > valueB) return this.sortOrder === 'asc' ? 1 : -1;
          return 0;
        });
        
        this.renderProducts();
      }
      
      getCategoryIcon(category) {
        const icons = {
          fruits: 'üçé',
          vegetables: 'ü•ï',
          dairy: 'ü•õ',
          bakery: 'üçû',
          groceries: 'üõí',
          meat: 'ü•©'
        };
        return icons[category] || 'üì¶';
      }
      
      getStockIndicator(stock) {
        if (stock === 0) {
          return '<span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Out of Stock</span>';
        } else if (stock < 10) {
          return '<span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">Low Stock</span>';
        } else {
          return '<span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">In Stock</span>';
        }
      }
      
      getStatusBadge(status) {
        const badges = {
          active: '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">‚úÖ Active</span>',
          inactive: '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">‚è∏Ô∏è Inactive</span>',
          out_of_stock: '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">‚ùå Out of Stock</span>',
          low_stock: '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">‚ö†Ô∏è Low Stock</span>',
          draft: '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">üìù Draft</span>'
        };
        
        return badges[status] || badges.active;
      }
      
      handleSearch(query) {
        this.filters.search = query.toLowerCase();
        this.applyFilters();
      }
      
      applyFilters() {
        this.filters.category = document.getElementById('categoryFilter').value;
        this.filters.status = document.getElementById('statusFilter').value;
        this.filters.seller = document.getElementById('sellerFilter').value;
        this.filters.minPrice = document.getElementById('minPrice').value;
        this.filters.maxPrice = document.getElementById('maxPrice').value;
        
        this.filteredProducts = this.products.filter(product => {
          const matchesSearch = !this.filters.search || 
            product.name.toLowerCase().includes(this.filters.search) ||
            product.sku.toLowerCase().includes(this.filters.search) ||
            product.description.toLowerCase().includes(this.filters.search);
          
          const matchesCategory = !this.filters.category || product.category === this.filters.category;
          const matchesStatus = !this.filters.status || product.status === this.filters.status;
          const matchesSeller = !this.filters.seller || product.sellerId === this.filters.seller;
          
          const matchesMinPrice = !this.filters.minPrice || product.price >= parseFloat(this.filters.minPrice);
          const matchesMaxPrice = !this.filters.maxPrice || product.price <= parseFloat(this.filters.maxPrice);
          
          return matchesSearch && matchesCategory && matchesStatus && matchesSeller && matchesMinPrice && matchesMaxPrice;
        });
        
        this.currentPage = 1;
        this.renderProducts();
        this.updateFilterResults();
      }
      
      resetFilters() {
        document.getElementById('categoryFilter').value = '';
        document.getElementById('statusFilter').value = '';
        document.getElementById('sellerFilter').value = '';
        document.getElementById('minPrice').value = '';
        document.getElementById('maxPrice').value = '';
        document.getElementById('globalSearch').value = '';
        
        this.filters = {};
        this.filteredProducts = [...this.products];
        this.currentPage = 1;
        this.renderProducts();
        this.updateFilterResults();
      }
      
      updateFilterResults() {
        const filterResults = document.getElementById('filterResults');
        const total = this.products.length;
        const filtered = this.filteredProducts.length;
        
        if (total === filtered) {
          filterResults.textContent = `Showing all ${total} products`;
        } else {
          filterResults.textContent = `Showing ${filtered} of ${total} products`;
        }
      }
      
      updatePagination() {
        const totalPages = Math.ceil(this.filteredProducts.length / this.itemsPerPage);
        const startItem = (this.currentPage - 1) * this.itemsPerPage + 1;
        const endItem = Math.min(this.currentPage * this.itemsPerPage, this.filteredProducts.length);
        
        document.getElementById('showingFrom').textContent = startItem;
        document.getElementById('showingTo').textContent = endItem;
        document.getElementById('totalItems').textContent = this.filteredProducts.length;
        
        // Update page numbers
        const pageNumbers = document.getElementById('pageNumbers');
        pageNumbers.innerHTML = '';
        
        // Always show first page
        if (this.currentPage > 3) {
          const firstButton = document.createElement('button');
          firstButton.className = `px-2 md:px-3 py-1 border border-gray-300 rounded hover:bg-gray-50`;
          firstButton.textContent = '1';
          firstButton.onclick = () => {
            this.currentPage = 1;
            this.renderProducts();
          };
          pageNumbers.appendChild(firstButton);
          
          if (this.currentPage > 4) {
            const ellipsis = document.createElement('span');
            ellipsis.className = 'px-2';
            ellipsis.textContent = '...';
            pageNumbers.appendChild(ellipsis);
          }
        }
        
        // Show pages around current page
        for (let i = Math.max(1, this.currentPage - 2); i <= Math.min(totalPages, this.currentPage + 2); i++) {
          const button = document.createElement('button');
          button.className = `px-2 md:px-3 py-1 border border-gray-300 rounded ${i === this.currentPage ? 'bg-blue-600 text-white' : 'hover:bg-gray-50'}`;
          button.textContent = i;
          button.onclick = () => {
            this.currentPage = i;
            this.renderProducts();
          };
          pageNumbers.appendChild(button);
        }
        
        // Always show last page
        if (this.currentPage < totalPages - 2) {
          if (this.currentPage < totalPages - 3) {
            const ellipsis = document.createElement('span');
            ellipsis.className = 'px-2';
            ellipsis.textContent = '...';
            pageNumbers.appendChild(ellipsis);
          }
          
          const lastButton = document.createElement('button');
          lastButton.className = `px-2 md:px-3 py-1 border border-gray-300 rounded hover:bg-gray-50`;
          lastButton.textContent = totalPages;
          lastButton.onclick = () => {
            this.currentPage = totalPages;
            this.renderProducts();
          };
          pageNumbers.appendChild(lastButton);
        }
        
        // Update prev/next buttons
        document.getElementById('prevPage').disabled = this.currentPage <= 1;
        document.getElementById('nextPage').disabled = this.currentPage >= totalPages;
        document.getElementById('jumpToPage').value = this.currentPage;
        document.getElementById('jumpToPage').max = totalPages;
      }
      
      setupPagination() {
        document.getElementById('prevPage').addEventListener('click', () => {
          if (this.currentPage > 1) {
            this.currentPage--;
            this.renderProducts();
          }
        });
        
        document.getElementById('nextPage').addEventListener('click', () => {
          const totalPages = Math.ceil(this.filteredProducts.length / this.itemsPerPage);
          if (this.currentPage < totalPages) {
            this.currentPage++;
            this.renderProducts();
          }
        });
        
        document.getElementById('jumpButton').addEventListener('click', () => {
          const page = parseInt(document.getElementById('jumpToPage').value);
          const totalPages = Math.ceil(this.filteredProducts.length / this.itemsPerPage);
          
          if (page >= 1 && page <= totalPages) {
            this.currentPage = page;
            this.renderProducts();
          } else {
            this.showNotification(`Please enter a page number between 1 and ${totalPages}`, 'error');
          }
        });
      }
      
      openProductModal(product = null) {
        this.editingProduct = product;
        const modal = document.getElementById('productModal');
        const modalContent = document.getElementById('modalContent');
        const title = document.getElementById('modalTitle');
        
        if (product) {
          title.textContent = 'Edit Product';
          this.populateForm(product);
        } else {
          title.textContent = 'Add New Product';
          this.resetForm();
          this.generateSKU();
        }
        
        modal.classList.remove('hidden');
        setTimeout(() => {
          modalContent.classList.remove('scale-95', 'opacity-0');
          modalContent.classList.add('scale-100', 'opacity-100');
        }, 10);
      }
      
      closeProductModal() {
        const modal = document.getElementById('productModal');
        const modalContent = document.getElementById('modalContent');
        
        modalContent.classList.remove('scale-100', 'opacity-100');
        modalContent.classList.add('scale-95', 'opacity-0');
        
        setTimeout(() => {
          modal.classList.add('hidden');
          this.editingProduct = null;
          this.resetForm();
        }, 300);
      }
      
      populateForm(product) {
        document.getElementById('productName').value = product.name;
        document.getElementById('productSKU').value = product.sku;
        document.getElementById('productCategory').value = product.category;
        document.getElementById('productDescription').value = product.description;
        document.getElementById('productPrice').value = product.price;
        document.getElementById('productComparePrice').value = product.comparePrice || '';
        document.getElementById('productStock').value = product.stock;
        document.getElementById('productSeller').value = product.sellerId;
        document.getElementById('productStatus').value = product.status;
        document.getElementById('featured').checked = product.featured;
        document.getElementById('productUnit').value = product.unit;
        
        // Set main image preview
        const preview = document.getElementById('mainImagePreview');
        const placeholder = document.getElementById('mainImagePlaceholder');
        const display = document.getElementById('mainImageDisplay');
        
        if (product.image) {
          display.src = product.image;
          preview.classList.remove('hidden');
          placeholder.classList.add('hidden');
        } else {
          preview.classList.add('hidden');
          placeholder.classList.remove('hidden');
        }
      }
      
      resetForm() {
        document.getElementById('productForm').reset();
        this.removeMainImage();
        document.getElementById('additionalImagesPreview').innerHTML = '';
      }
      
      generateSKU() {
        const timestamp = Date.now().toString().slice(-6);
        const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
        document.getElementById('productSKU').value = `SKU-${timestamp}-${random}`;
      }
      
      saveProduct() {
        const formData = this.collectFormData();
        
        if (!formData.name || !formData.sku || !formData.category || !formData.price || !formData.stock || !formData.sellerId) {
          this.showNotification('Please fill in all required fields', 'error');
          return;
        }
        
        if (this.editingProduct) {
          const index = this.products.findIndex(p => p.id === this.editingProduct.id);
          if (index !== -1) {
            this.products[index] = { ...this.products[index], ...formData };
          }
          this.showNotification('Product updated successfully!', 'success');
        } else {
          const newProduct = {
            ...formData,
            id: `PRD-${String(this.products.length + 1).padStart(4, '0')}`,
            image: 'https://picsum.photos/400/300?random=' + (this.products.length + 1),
            rating: '5.0',
            sales: 0,
            createdAt: new Date()
          };
          this.products.push(newProduct);
          this.showNotification('Product added successfully!', 'success');
        }
        
        this.closeProductModal();
        this.applyFilters();
        this.updateStats();
      }
      
      saveProductAsDraft() {
        const formData = this.collectFormData();
        formData.status = 'draft';
        
        if (!formData.name || !formData.sku || !formData.category) {
          this.showNotification('Please fill in at least name, SKU and category', 'error');
          return;
        }
        
        const newProduct = {
          ...formData,
          id: `PRD-${String(this.products.length + 1).padStart(4, '0')}`,
          image: 'https://picsum.photos/400/300?random=' + (this.products.length + 1),
          price: formData.price || 0,
          stock: formData.stock || 0,
          rating: '0.0',
          sales: 0,
          createdAt: new Date()
        };
        
        this.products.push(newProduct);
        this.showNotification('Product saved as draft!', 'success');
        this.closeProductModal();
        this.applyFilters();
        this.updateStats();
      }
      
      collectFormData() {
        return {
          name: document.getElementById('productName').value,
          sku: document.getElementById('productSKU').value,
          category: document.getElementById('productCategory').value,
          description: document.getElementById('productDescription').value,
          price: parseFloat(document.getElementById('productPrice').value) || 0,
          comparePrice: parseFloat(document.getElementById('productComparePrice').value) || null,
          stock: parseInt(document.getElementById('productStock').value) || 0,
          seller: document.getElementById('productSeller').options[document.getElementById('productSeller').selectedIndex].text,
          sellerId: document.getElementById('productSeller').value,
          status: document.getElementById('productStatus').value,
          featured: document.getElementById('featured').checked,
          unit: document.getElementById('productUnit').value
        };
      }
      
      viewProduct(productId) {
        const product = this.products.find(p => p.id === productId);
        if (product) {
          // In a real app, this would open a detailed view modal
          this.showNotification(`Viewing ${product.name}`, 'info');
        }
      }
      
      editProduct(productId) {
        const product = this.products.find(p => p.id === productId);
        if (product) {
          this.openProductModal(product);
        }
      }
      
      duplicateProduct(productId) {
        const product = this.products.find(p => p.id === productId);
        if (product) {
          const newProduct = {
            ...product,
            id: `PRD-${String(this.products.length + 1).padStart(4, '0')}`,
            name: product.name + ' (Copy)',
            sku: product.sku + '-COPY',
            image: `https://picsum.photos/400/300?random=${this.products.length + 1}`,
            createdAt: new Date(),
            sales: 0
          };
          this.products.push(newProduct);
          this.applyFilters();
          this.updateStats();
          this.showNotification('Product duplicated successfully!', 'success');
        }
      }
      
      deleteProduct(productId) {
        if (confirm('Are you sure you want to delete this product? This action cannot be undone.')) {
          this.products = this.products.filter(p => p.id !== productId);
          this.applyFilters();
          this.updateStats();
          this.showNotification('Product deleted successfully!', 'success');
        }
      }
      
      updateSelectedProducts() {
        this.selectedProducts = Array.from(document.querySelectorAll('.product-checkbox:checked')).map(cb => cb.value);
        document.getElementById('bulkActions').disabled = this.selectedProducts.length === 0;
      }
      
      toggleBulkActionsDropdown(e) {
        e.stopPropagation();
        const dropdown = document.getElementById('bulkActionsDropdown');
        
        if (this.selectedProducts.length === 0) {
          this.showNotification('Please select products for bulk actions', 'warning');
          return;
        }
        
        if (dropdown.classList.contains('hidden')) {
          dropdown.classList.remove('hidden');
          dropdown.classList.add('slide-in-right');
        } else {
          dropdown.classList.add('hidden');
        }
      }
      
      performBulkAction(action) {
        if (this.selectedProducts.length === 0) {
          this.showNotification('No products selected', 'warning');
          return;
        }
        
        let updated = 0;
        let message = '';
        
        this.selectedProducts.forEach(id => {
          const index = this.products.findIndex(p => p.id === id);
          if (index !== -1) {
            switch (action) {
              case 'activate':
                this.products[index].status = 'active';
                updated++;
                message = `${updated} products activated`;
                break;
              case 'deactivate':
                this.products[index].status = 'inactive';
                updated++;
                message = `${updated} products deactivated`;
                break;
              case 'delete':
                this.products.splice(index, 1);
                updated++;
                message = `${updated} products deleted`;
                break;
            }
          }
        });
        
        // Close dropdown
        document.getElementById('bulkActionsDropdown').classList.add('hidden');
        
        // Clear selection
        document.querySelectorAll('.product-checkbox').forEach(cb => cb.checked = false);
        this.selectedProducts = [];
        
        this.applyFilters();
        this.updateStats();
        this.showNotification(message, 'success');
      }
      
      showCategoryUpdateModal() {
        document.getElementById('bulkActionsDropdown').classList.add('hidden');
        document.getElementById('updateCategoryModal').classList.remove('hidden');
      }
      
      closeCategoryUpdateModal() {
        document.getElementById('updateCategoryModal').classList.add('hidden');
      }
      
      updateBulkCategory() {
        const newCategory = document.getElementById('bulkCategorySelect').value;
        
        if (this.selectedProducts.length === 0) {
          this.showNotification('No products selected', 'warning');
          return;
        }
        
        let updated = 0;
        
        this.selectedProducts.forEach(id => {
          const index = this.products.findIndex(p => p.id === id);
          if (index !== -1) {
            this.products[index].category = newCategory;
            updated++;
          }
        });
        
        this.closeCategoryUpdateModal();
        
        // Clear selection
        document.querySelectorAll('.product-checkbox').forEach(cb => cb.checked = false);
        this.selectedProducts = [];
        
        this.applyFilters();
        this.updateStats();
        this.showNotification(`Updated category for ${updated} products`, 'success');
      }
      
      updateStats() {
        const total = this.products.length;
        const active = this.products.filter(p => p.status === 'active').length;
        const outOfStock = this.products.filter(p => p.stock === 0).length;
        const lowStock = this.products.filter(p => p.stock > 0 && p.stock < 10).length;
        
        // Remove loading placeholders
        document.querySelectorAll('.loading-placeholder').forEach(el => el.remove());
        
        document.getElementById('totalProducts').textContent = total.toLocaleString();
        document.getElementById('activeProducts').textContent = active.toLocaleString();
        document.getElementById('outOfStock').textContent = outOfStock.toLocaleString();
        document.getElementById('lowStock').textContent = lowStock.toLocaleString();
        document.getElementById('totalCount').textContent = total.toLocaleString();
        
        // Update growth indicators
        const growthElements = {
          total: { element: document.querySelector('#totalProducts + div'), change: 15.3 },
          active: { element: document.querySelector('#activeProducts + div'), change: 8.7 },
          outOfStock: { element: document.querySelector('#outOfStock + div'), change: -12.1 }
        };
        
        for (const [key, data] of Object.entries(growthElements)) {
          const change = data.change;
          const isPositive = change >= 0;
          
          data.element.innerHTML = `
            <i class="fas fa-arrow-${isPositive ? 'up' : 'down'} text-${isPositive ? 'green' : 'red'}-500 text-xs mr-1"></i>
            <span class="text-${isPositive ? 'green' : 'red'}-500 text-xs font-medium">${isPositive ? '+' : ''}${change}%</span>
            <span class="text-gray-400 text-xs ml-1">${key === 'outOfStock' ? 'improvement' : key === 'active' ? 'healthy growth' : 'vs last month'}</span>
          `;
        }
      }
      
      showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg text-white transition-all duration-300 transform translate-x-full`;
        
        const colors = {
          success: 'bg-green-600',
          error: 'bg-red-600',
          info: 'bg-blue-600',
          warning: 'bg-yellow-600'
        };
        
        const icons = {
          success: 'fas fa-check-circle',
          error: 'fas fa-exclamation-circle',
          info: 'fas fa-info-circle',
          warning: 'fas fa-exclamation-triangle'
        };
        
        notification.classList.add(colors[type]);
        notification.innerHTML = `
          <div class="flex items-center">
            <i class="${icons[type]} mr-2"></i>
            <span class="text-sm">${message}</span>
            <button class="ml-3 text-white hover:text-gray-200" onclick="this.parentElement.parentElement.remove()">
              <i class="fas fa-times"></i>
            </button>
          </div>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.classList.remove('translate-x-full');
        }, 100);
        
        setTimeout(() => {
          if (document.body.contains(notification)) {
            notification.classList.add('translate-x-full');
            setTimeout(() => {
              document.body.removeChild(notification);
            }, 300);
          }
        }, 4000);
      }
      
      debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }
    }
    
    // Initialize when DOM is loaded
    let productManager;
    document.addEventListener('DOMContentLoaded', () => {
      productManager = new ProductManager();
      
      // Simulate loading delay
      setTimeout(() => {
        productManager.renderProducts();
        productManager.updateStats();
      }, 1000);
    });
  </script>
</body>
</html>