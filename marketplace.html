<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸš€ QuickLocal - Secure Checkout</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-solid: #667eea;
            --primary-dark: #5a67d8;
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --warning: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            --error: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            --premium-gold: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            
            --text-primary: #1a202c;
            --text-secondary: #718096;
            --text-light: #a0aec0;
            --text-inverse: #ffffff;
            
            --bg-primary: #ffffff;
            --bg-secondary: #f7fafc;
            --bg-dark: #1a202c;
            --bg-glass: rgba(255, 255, 255, 0.25);
            --bg-glass-dark: rgba(0, 0, 0, 0.25);
            
            --border: rgba(255, 255, 255, 0.18);
            --border-solid: #e2e8f0;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1);
            --shadow-glow: 0 0 20px rgba(102, 126, 234, 0.3);
            --shadow-premium: 0 25px 50px rgba(0, 0, 0, 0.15);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            --transition-spring: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
            position: relative;
        }

        /* Enhanced Background Effects */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 25% 25%, rgba(102, 126, 234, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(240, 147, 251, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(79, 172, 254, 0.03) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
            animation: backgroundFloat 20s ease-in-out infinite;
        }

        @keyframes backgroundFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-20px, -20px) rotate(1deg); }
            50% { transform: translate(20px, -10px) rotate(-1deg); }
            75% { transform: translate(-10px, 20px) rotate(0.5deg); }
        }

        /* Enhanced Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-size: 2rem;
            font-weight: 900;
            background: var(--primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: var(--transition-spring);
        }

        .logo:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 0 15px rgba(102, 126, 234, 0.4));
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 2px solid var(--border-solid);
            border-radius: var(--radius-full);
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition-spring);
            position: relative;
            overflow: hidden;
        }

        .back-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--primary);
            transform: translateX(-100%);
            transition: var(--transition);
        }

        .back-btn:hover::before {
            transform: translateX(0);
        }

        .back-btn:hover {
            color: white;
            border-color: var(--primary-solid);
            transform: translateY(-2px);
        }

        .back-btn span {
            position: relative;
            z-index: 1;
        }

        .back-btn i {
            position: relative;
            z-index: 1;
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .checkout-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 3rem;
            align-items: start;
        }

        /* Checkout Steps */
        .checkout-steps {
            display: flex;
            justify-content: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
        }

        .step {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 2rem;
            border-radius: var(--radius-lg);
            transition: var(--transition);
            position: relative;
        }

        .step.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow-glow);
        }

        .step.completed {
            background: var(--success);
            color: var(--text-primary);
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .step.active .step-number {
            background: rgba(255, 255, 255, 0.3);
        }

        .step.completed .step-number {
            background: rgba(16, 185, 129, 0.2);
        }

        .step-text {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .step::after {
            content: '';
            position: absolute;
            right: -1.5rem;
            width: 3rem;
            height: 2px;
            background: var(--border-solid);
            top: 50%;
            transform: translateY(-50%);
        }

        .step:last-child::after {
            display: none;
        }

        /* Forms Section */
        .forms-section {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: 2.5rem;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .forms-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: var(--primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section-subtitle {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border-solid);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            background: var(--bg-secondary);
            transition: var(--transition);
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-solid);
            box-shadow: var(--shadow-glow);
            background: var(--bg-primary);
            transform: translateY(-2px);
        }

        .form-input.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        .error-message {
            color: #ef4444;
            font-size: 0.85rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-select {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border-solid);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            background: var(--bg-secondary);
            transition: var(--transition);
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary-solid);
            box-shadow: var(--shadow-glow);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-solid);
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            transition: var(--transition);
        }

        .checkbox:checked {
            background: var(--primary-solid);
            border-color: var(--primary-solid);
        }

        .checkbox:checked::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .checkbox-label {
            font-size: 0.95rem;
            color: var(--text-secondary);
            cursor: pointer;
        }

        /* Payment Methods */
        .payment-methods {
            margin-top: 2rem;
        }

        .payment-method {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem;
            border: 2px solid var(--border-solid);
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            cursor: pointer;
            transition: var(--transition-spring);
            background: var(--bg-secondary);
            position: relative;
            overflow: hidden;
        }

        .payment-method::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--primary);
            opacity: 0;
            transition: var(--transition);
        }

        .payment-method:hover::before {
            opacity: 0.05;
        }

        .payment-method.selected {
            border-color: var(--primary-solid);
            background: rgba(102, 126, 234, 0.05);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .payment-method:hover {
            border-color: var(--primary-solid);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .payment-radio {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-solid);
            border-radius: 50%;
            position: relative;
            z-index: 1;
        }

        .payment-method.selected .payment-radio {
            border-color: var(--primary-solid);
            background: var(--primary-solid);
        }

        .payment-method.selected .payment-radio::after {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .payment-icon {
            font-size: 1.5rem;
            color: var(--primary-solid);
            z-index: 1;
            position: relative;
        }

        .payment-details {
            flex: 1;
            z-index: 1;
            position: relative;
        }

        .payment-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .payment-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Order Summary */
        .order-summary {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: 2.5rem;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 120px;
            height: fit-content;
        }

        .summary-title {
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 2rem;
            background: var(--primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        .order-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem 0;
            border-bottom: 1px solid var(--border-solid);
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .item-image {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-md);
            object-fit: cover;
            box-shadow: var(--shadow-sm);
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }

        .item-quantity {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .item-price {
            font-weight: 700;
            color: var(--primary-solid);
            font-size: 1.1rem;
        }

        .order-totals {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--border-solid);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .total-row.final {
            font-weight: 800;
            font-size: 1.3rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-solid);
            background: var(--primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .checkout-btn {
            width: 100%;
            padding: 1.25rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition-spring);
            margin-top: 2rem;
            position: relative;
            overflow: hidden;
        }

        .checkout-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: var(--transition);
        }

        .checkout-btn:hover::before {
            left: 100%;
        }

        .checkout-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-premium);
            background: var(--secondary);
        }

        .checkout-btn:disabled {
            background: var(--text-light);
            cursor: not-allowed;
            transform: none;
        }

        .security-badges {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-solid);
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 600;
        }

        .security-badge i {
            color: #10b981;
        }

        /* Success Animation */
        .success-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .success-content {
            background: white;
            padding: 3rem;
            border-radius: var(--radius-xl);
            text-align: center;
            max-width: 500px;
            animation: successPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes successPop {
            0% { transform: scale(0.3) rotateX(90deg); opacity: 0; }
            100% { transform: scale(1) rotateX(0deg); opacity: 1; }
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: var(--success);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2.5rem;
            color: white;
            animation: checkmarkDraw 1s ease-in-out 0.3s both;
        }

        @keyframes checkmarkDraw {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .success-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .success-message {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .success-btn {
            padding: 1rem 2rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius-full);
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition-spring);
        }

        .success-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Toast Styles */
        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 10000;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.error {
            background: #e74c3c;
        }

        .toast.warning {
            background: #f39c12;
        }

        .toast.info {
            background: #3498db;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Loading Spinner */
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 2px solid white;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .checkout-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .order-summary {
                position: static;
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .checkout-steps {
                flex-direction: column;
                gap: 1rem;
            }

            .step::after {
                display: none;
            }

            .forms-section {
                padding: 2rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .step {
                justify-content: center;
                padding: 1rem;
            }

            .nav {
                padding: 0 1rem;
            }

            .logo {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .forms-section {
                padding: 1.5rem;
            }

            .order-summary {
                padding: 1.5rem;
            }

            .section-title {
                font-size: 1.5rem;
            }

            .summary-title {
                font-size: 1.5rem;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --text-primary: #f7fafc;
                --text-secondary: #a0aec0;
                --text-light: #718096;
                --bg-primary: #1a202c;
                --bg-secondary: #2d3748;
                --bg-glass: rgba(0, 0, 0, 0.25);
                --border: rgba(255, 255, 255, 0.1);
                --border-solid: #4a5568;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Enhanced Header -->
    <header class="header">
        <nav class="nav">
            <a href="/" class="logo">
                <i class="fas fa-rocket"></i>
                QuickLocal
            </a>
            
            <a href="../marketplace.html" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                <span>Back to Shopping</span>
            </a>
        </nav>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Checkout Steps -->
        <div class="checkout-steps">
            <div class="step completed">
                <div class="step-number">1</div>
                <div class="step-text">Cart Review</div>
            </div>
            <div class="step active">
                <div class="step-number">2</div>
                <div class="step-text">Shipping & Payment</div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div class="step-text">Confirmation</div>
            </div>
        </div>

        <!-- Checkout Grid -->
        <div class="checkout-grid">
            <!-- Forms Section -->
            <div class="forms-section">
                <h2 class="section-title">Shipping Information</h2>
                <p class="section-subtitle">Please provide your delivery details</p>
                
                <form id="checkoutForm">
                    <!-- Contact Information -->
                    <div class="form-group">
                        <label class="form-label" for="email">Email Address</label>
                        <input type="email" id="email" class="form-input" placeholder="your@email.com" required>
                        <div class="error-message" id="emailError" style="display: none;">
                            <i class="fas fa-exclamation-circle"></i>
                            Please enter a valid email address
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="firstName">First Name</label>
                            <input type="text" id="firstName" class="form-input" placeholder="John" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="lastName">Last Name</label>
                            <input type="text" id="lastName" class="form-input" placeholder="Doe" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="phone">Phone Number</label>
                        <input type="tel" id="phone" class="form-input" placeholder="+1 (555) 123-4567" required>
                    </div>

                    <!-- Shipping Address -->
                    <div class="form-group" style="margin-top: 2rem;">
                        <label class="form-label" for="address">Street Address</label>
                        <input type="text" id="address" class="form-input" placeholder="123 Main Street" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="city">City</label>
                            <input type="text" id="city" class="form-input" placeholder="New York" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="state">State</label>
                            <select id="state" class="form-select" required>
                                <option value="">Select State</option>
                                <option value="NY">New York</option>
                                <option value="CA">California</option>
                                <option value="TX">Texas</option>
                                <option value="FL">Florida</option>
                                <option value="IL">Illinois</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="OH">Ohio</option>
                                <option value="GA">Georgia</option>
                                <option value="NC">North Carolina</option>
                                <option value="MI">Michigan</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="zip">ZIP Code</label>
                            <input type="text" id="zip" class="form-input" placeholder="10001" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="country">Country</label>
                            <select id="country" class="form-select" required>
                                <option value="US">United States</option>
                                <option value="CA">Canada</option>
                                <option value="UK">United Kingdom</option>
                                <option value="AU">Australia</option>
                            </select>
                        </div>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="sameAsBilling" class="checkbox">
                        <label for="sameAsBilling" class="checkbox-label">Use this address for billing</label>
                    </div>

                    <!-- Payment Methods -->
                    <div class="payment-methods">
                        <h3 class="section-title" style="margin-top: 3rem; margin-bottom: 1rem;">Payment Method</h3>
                        <p class="section-subtitle" style="margin-bottom: 2rem;">Choose your preferred payment option</p>

                        <div class="payment-method selected" data-method="card">
                            <div class="payment-radio"></div>
                            <div class="payment-icon">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="payment-details">
                                <div class="payment-name">Credit/Debit Card</div>
                                <div class="payment-description">Visa, Mastercard, American Express</div>
                            </div>
                        </div>

                        <div class="payment-method" data-method="paypal">
                            <div class="payment-radio"></div>
                            <div class="payment-icon">
                                <i class="fab fa-paypal"></i>
                            </div>
                            <div class="payment-details">
                                <div class="payment-name">PayPal</div>
                                <div class="payment-description">Pay with your PayPal account</div>
                            </div>
                        </div>

                        <div class="payment-method" data-method="apple">
                            <div class="payment-radio"></div>
                            <div class="payment-icon">
                                <i class="fab fa-apple"></i>
                            </div>
                            <div class="payment-details">
                                <div class="payment-name">Apple Pay</div>
                                <div class="payment-description">Quick and secure payment</div>
                            </div>
                        </div>

                        <div class="payment-method" data-method="google">
                            <div class="payment-radio"></div>
                            <div class="payment-icon">
                                <i class="fab fa-google"></i>
                            </div>
                            <div class="payment-details">
                                <div class="payment-name">Google Pay</div>
                                <div class="payment-description">Pay with Google</div>
                            </div>
                        </div>
                    </div>

                    <!-- Card Details (shown when card payment is selected) -->
                    <div id="cardDetails" style="margin-top: 2rem;">
                        <div class="form-group">
                            <label class="form-label" for="cardNumber">Card Number</label>
                            <input type="text" id="cardNumber" class="form-input" placeholder="1234 5678 9012 3456" maxlength="19">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="expiryDate">Expiry Date</label>
                                <input type="text" id="expiryDate" class="form-input" placeholder="MM/YY" maxlength="5">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="cvv">CVV</label>
                                <input type="text" id="cvv" class="form-input" placeholder="123" maxlength="4">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="cardName">Name on Card</label>
                            <input type="text" id="cardName" class="form-input" placeholder="John Doe">
                        </div>
                    </div>

                    <div class="checkbox-group" style="margin-top: 2rem;">
                        <input type="checkbox" id="savePayment" class="checkbox">
                        <label for="savePayment" class="checkbox-label">Save payment information for future purchases</label>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="agreeTerms" class="checkbox" required>
                        <label for="agreeTerms" class="checkbox-label">I agree to the <a href="#" style="color: var(--primary-solid);">Terms of Service</a> and <a href="#" style="color: var(--primary-solid);">Privacy Policy</a></label>
                    </div>
                </form>
            </div>

            <!-- Order Summary -->
            <div class="order-summary">
                <h3 class="summary-title">Order Summary</h3>
                
                <div id="orderItems">
                    <!-- Order items will be dynamically loaded here -->
                </div>

                <div class="order-totals">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Shipping:</span>
                        <span id="shipping">$9.99</span>
                    </div>
                    <div class="total-row">
                        <span>Tax:</span>
                        <span id="tax">$0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Discount:</span>
                        <span id="discount" style="color: #10b981;">-$0.00</span>
                    </div>
                    <div class="total-row final">
                        <span>Total:</span>
                        <span id="finalTotal">$0.00</span>
                    </div>
                </div>

                <button class="checkout-btn" id="placeOrderBtn">
                    <div class="loading-spinner" id="loadingSpinner"></div>
                    <i class="fas fa-lock"></i>
                    Place Secure Order
                </button>

                <div class="security-badges">
                    <div class="security-badge">
                        <i class="fas fa-shield-alt"></i>
                        SSL Secured
                    </div>
                    <div class="security-badge">
                        <i class="fas fa-lock"></i>
                        256-bit Encryption
                    </div>
                    <div class="security-badge">
                        <i class="fas fa-credit-card"></i>
                        PCI Compliant
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Animation -->
    <div class="success-animation" id="successAnimation">
        <div class="success-content">
            <div class="success-icon">
                <i class="fas fa-check"></i>
            </div>
            <h2 class="success-title">Order Placed Successfully!</h2>
            <p class="success-message">Thank you for your purchase. You'll receive a confirmation email shortly.</p>
            <button class="success-btn" onclick="goToOrderHistory()">View Order Details</button>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <script>
        // Checkout state
        const checkoutState = {
            cart: [],
            selectedPayment: 'card',
            subtotal: 0,
            shipping: 9.99,
            tax: 0,
            discount: 0,
            finalTotal: 0
        };

        // Initialize checkout
        document.addEventListener('DOMContentLoaded', function() {
            initializeCheckout();
        });

        function initializeCheckout() {
            loadCartData();
            setupEventListeners();
            setupFormValidation();
            calculateTotals();
            renderOrderSummary();
        }

        function loadCartData() {
            try {
                // Try to load from sessionStorage first (most recent)
                let cartData = sessionStorage.getItem('current_cart') || sessionStorage.getItem('quicklocal_cart');
                
                // Fallback to localStorage
                if (!cartData) {
                    cartData = localStorage.getItem('quicklocal_cart');
                }

                if (cartData) {
                    checkoutState.cart = JSON.parse(cartData);
                } else {
                    // Fallback demo data if no cart found
                    checkoutState.cart = [
                        {
                            id: 1,
                            name: "Premium Wireless Headphones",
                            price: 299.99,
                            quantity: 1,
                            image: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=60&h=60&fit=crop&crop=center"
                        },
                        {
                            id: 2,
                            name: "Designer Cotton T-Shirt",
                            price: 89.99,
                            quantity: 2,
                            image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=60&h=60&fit=crop&crop=center"
                        }
                    ];
                    showToast('Demo cart loaded - Add items from the marketplace!', 'info');
                }

                if (checkoutState.cart.length === 0) {
                    showToast('Your cart is empty! Redirecting to marketplace...', 'warning');
                    setTimeout(() => {
                        window.location.href = '../marketplace.html';
                    }, 3000);
                }
            } catch (error) {
                console.error('Error loading cart data:', error);
                showToast('Error loading cart data', 'error');
            }
        }

        function setupEventListeners() {
            // Payment method selection
            document.querySelectorAll('.payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    selectPaymentMethod(this.dataset.method);
                });
            });

            // Form inputs
            setupInputFormatting();

            // Place order button
            document.getElementById('placeOrderBtn').addEventListener('click', placeOrder);

            // Checkbox handling
            document.getElementById('sameAsBilling').addEventListener('change', function() {
                if (this.checked) {
                    showToast('Billing address set to shipping address', 'info');
                }
            });
        }

        function setupInputFormatting() {
            // Card number formatting
            const cardNumberInput = document.getElementById('cardNumber');
            cardNumberInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
                if (formattedValue !== e.target.value) {
                    e.target.value = formattedValue;
                }
            });

            // Expiry date formatting
            const expiryInput = document.getElementById('expiryDate');
            expiryInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                e.target.value = value;
            });

            // CVV formatting
            const cvvInput = document.getElementById('cvv');
            cvvInput.addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/\D/g, '');
            });

            // Phone number formatting
            const phoneInput = document.getElementById('phone');
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 0) {
                    value = value.replace(/(\d{3})(\d{3})(\d{4})/, '($1) $2-$3');
                }
                e.target.value = value;
            });
        }

        function selectPaymentMethod(method) {
            checkoutState.selectedPayment = method;
            
            // Update UI
            document.querySelectorAll('.payment-method').forEach(pm => {
                pm.classList.remove('selected');
            });
            document.querySelector(`[data-method="${method}"]`).classList.add('selected');

            // Show/hide card details
            const cardDetails = document.getElementById('cardDetails');
            if (method === 'card') {
                cardDetails.style.display = 'block';
            } else {
                cardDetails.style.display = 'none';
            }

            showToast(`${method.charAt(0).toUpperCase() + method.slice(1)} payment selected`, 'info');
        }

        function setupFormValidation() {
            const form = document.getElementById('checkoutForm');
            const inputs = form.querySelectorAll('input[required], select[required]');

            inputs.forEach(input => {
                input.addEventListener('blur', function() {
                    validateField(this);
                });

                input.addEventListener('input', function() {
                    if (this.classList.contains('error')) {
                        validateField(this);
                    }
                });
            });

            // Email validation
            const emailInput = document.getElementById('email');
            emailInput.addEventListener('input', function() {
                const emailError = document.getElementById('emailError');
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                
                if (this.value && !emailRegex.test(this.value)) {
                    this.classList.add('error');
                    emailError.style.display = 'flex';
                } else {
                    this.classList.remove('error');
                    emailError.style.display = 'none';
                }
            });
        }

        function validateField(field) {
            const isValid = field.checkValidity();
            
            if (!isValid) {
                field.classList.add('error');
                return false;
            } else {
                field.classList.remove('error');
                return true;
            }
        }

        function validateForm() {
            const form = document.getElementById('checkoutForm');
            const requiredFields = form.querySelectorAll('input[required], select[required]');
            let isValid = true;

            requiredFields.forEach(field => {
                if (!validateField(field)) {
                    isValid = false;
                }
            });

            // Additional validations
            const email = document.getElementById('email').value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                document.getElementById('email').classList.add('error');
                document.getElementById('emailError').style.display = 'flex';
                isValid = false;
            }

            if (checkoutState.selectedPayment === 'card') {
                const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
                const expiryDate = document.getElementById('expiryDate').value;
                const cvv = document.getElementById('cvv').value;

                if (cardNumber.length < 13 || cardNumber.length > 19) {
                    document.getElementById('cardNumber').classList.add('error');
                    isValid = false;
                }

                if (!/^\d{2}\/\d{2}$/.test(expiryDate)) {
                    document.getElementById('expiryDate').classList.add('error');
                    isValid = false;
                }

                if (cvv.length < 3 || cvv.length > 4) {
                    document.getElementById('cvv').classList.add('error');
                    isValid = false;
                }
            }

            const agreeTerms = document.getElementById('agreeTerms');
            if (!agreeTerms.checked) {
                showToast('Please agree to the terms and conditions', 'error');
                isValid = false;
            }

            return isValid;
        }

        function calculateTotals() {
            checkoutState.subtotal = checkoutState.cart.reduce((sum, item) => {
                return sum + (item.price * item.quantity);
            }, 0);

            // Calculate tax (8.5% example)
            checkoutState.tax = checkoutState.subtotal * 0.085;

            // Apply free shipping for orders over $100
            if (checkoutState.subtotal > 100) {
                checkoutState.shipping = 0;
                showToast('Free shipping applied!', 'success');
            }

            // Calculate final total
            checkoutState.finalTotal = checkoutState.subtotal + checkoutState.shipping + checkoutState.tax - checkoutState.discount;

            updateTotalsDisplay();
        }

        function updateTotalsDisplay() {
            document.getElementById('subtotal').textContent = `${checkoutState.subtotal.toFixed(2)}`;
            document.getElementById('shipping').textContent = checkoutState.shipping === 0 ? 'FREE' : `${checkoutState.shipping.toFixed(2)}`;
            document.getElementById('tax').textContent = `${checkoutState.tax.toFixed(2)}`;
            document.getElementById('discount').textContent = checkoutState.discount > 0 ? `-${checkoutState.discount.toFixed(2)}` : '$0.00';
            document.getElementById('finalTotal').textContent = `${checkoutState.finalTotal.toFixed(2)}`;
        }

        function renderOrderSummary() {
            const container = document.getElementById('orderItems');
            
            if (checkoutState.cart.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                        <i class="fas fa-shopping-cart" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>No items in cart</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = checkoutState.cart.map(item => `
                <div class="order-item">
                    <img src="${item.image}" alt="${item.name}" class="item-image" loading="lazy">
                    <div class="item-details">
                        <div class="item-name">${item.name}</div>
                        <div class="item-quantity">Qty: ${item.quantity}</div>
                    </div>
                    <div class="item-price">${(item.price * item.quantity).toFixed(2)}</div>
                </div>
            `).join('');
        }

        function placeOrder() {
            if (!validateForm()) {
                showToast('Please fill in all required fields correctly', 'error');
                return;
            }

            const orderButton = document.getElementById('placeOrderBtn');
            const loadingSpinner = document.getElementById('loadingSpinner');
            
            // Show loading state
            orderButton.disabled = true;
            loadingSpinner.style.display = 'inline-block';
            orderButton.innerHTML = '<div class="loading-spinner" style="display: inline-block;"></div> Processing Order...';

            // Simulate order processing
            setTimeout(() => {
                // Generate order number
                const orderNumber = 'QL' + Date.now().toString().slice(-8);
                
                // Clear cart
                clearCart();
                
                // Show success animation
                showSuccessAnimation(orderNumber);
                
                // Reset button
                orderButton.disabled = false;
                loadingSpinner.style.display = 'none';
                orderButton.innerHTML = '<i class="fas fa-lock"></i> Place Secure Order';
                
            }, 3000);
        }

        function clearCart() {
            try {
                localStorage.removeItem('quicklocal_cart');
                sessionStorage.removeItem('current_cart');
                sessionStorage.removeItem('quicklocal_cart');
                checkoutState.cart = [];
            } catch (error) {
                console.error('Error clearing cart:', error);
            }
        }

        function showSuccessAnimation(orderNumber) {
            const successAnimation = document.getElementById('successAnimation');
            successAnimation.style.display = 'flex';
            
            // Update success message with order number
            const successMessage = successAnimation.querySelector('.success-message');
            successMessage.textContent = `Your order #${orderNumber} has been confirmed. You'll receive a confirmation email shortly.`;
            
            showToast(`Order #${orderNumber} placed successfully!`, 'success');
        }

        function goToOrderHistory() {
            showToast('Redirecting to order history...', 'info');
            // In a real app, this would redirect to order history page
            setTimeout(() => {
                window.location.href = '../marketplace.html';
            }, 1500);
        }

        function showToast(message, type = 'success') {
            const toastContainer = document.getElementById('toastContainer');
            const toastId = 'toast-' + Date.now();
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.id = toastId;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 
                                  type === 'error' ? 'exclamation-circle' : 
                                  type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            toastContainer.appendChild(toast);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + Enter to place order
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                placeOrder();
            }
        });

        // Prevent form submission on Enter
        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            placeOrder();
        });

        // Auto-save form data (in a real app, you might want to save to localStorage)
        function autoSaveFormData() {
            const formData = {
                email: document.getElementById('email').value,
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                zip: document.getElementById('zip').value,
                country: document.getElementById('country').value
            };
            
            try {
                sessionStorage.setItem('checkout_form_data', JSON.stringify(formData));
            } catch (error) {
                console.warn('Could not save form data');
            }
        }

        // Load saved form data
        function loadSavedFormData() {
            try {
                const savedData = sessionStorage.getItem('checkout_form_data');
                if (savedData) {
                    const formData = JSON.parse(savedData);
                    Object.keys(formData).forEach(key => {
                        const element = document.getElementById(key);
                        if (element && formData[key]) {
                            element.value = formData[key];
                        }
                    });
                }
            } catch (error) {
                console.warn('Could not load saved form data');
            }
        }

        // Auto-save form data on input
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedFormData();
            
            const inputs = document.querySelectorAll('#checkoutForm input, #checkoutForm select');
            inputs.forEach(input => {
                input.addEventListener('input', debounce(autoSaveFormData, 1000));
            });
        });

        // Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Page visibility change - save form data when user leaves
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                autoSaveFormData();
            }
        });

        // Before page unload - save form data
        window.addEventListener('beforeunload', function() {
            autoSaveFormData();
        });
    </script>
</body>
</html>