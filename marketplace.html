<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 QuickLocal - Premium Marketplace</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4338ca;
            --primary-light: #a5b4fc;
            --secondary: #f59e0b;
            --accent: #10b981;
            --accent-dark: #059669;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-light: #94a3b8;
            --text-inverse: #ffffff;
            
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-dark: #0f172a;
            --bg-glass: rgba(255, 255, 255, 0.1);
            
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --border-dark: #cbd5e1;
            
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            --shadow-glow: 0 0 0 1px rgba(99, 102, 241, 0.05), 0 4px 16px rgba(99, 102, 241, 0.12);
            --shadow-glow-lg: 0 0 0 1px rgba(99, 102, 241, 0.1), 0 8px 32px rgba(99, 102, 241, 0.2);
            
            --radius-sm: 0.375rem;
            --radius: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --radius-2xl: 2rem;
            --radius-full: 9999px;
            
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* Enhanced Header */
        .header {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            transition: var(--transition);
        }
        .header.scrolled {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: var(--shadow-lg);
            border-bottom-color: var(--border-dark);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 2rem;
        }

        .nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem;
        }

        .logo {
            font-size: 1.875rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition-bounce);
        }
        .logo:hover {
            transform: scale(1.05);
        }
        .logo i {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(2px 2px 4px rgba(99, 102, 241, 0.2));
        }

        /* Enhanced Search */
        .search-container {
            flex: 1;
            max-width: 600px;
            position: relative;
        }

        .search-wrapper {
            position: relative;
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
            overflow: hidden;
        }
        .search-wrapper:focus-within {
            border-color: var(--primary);
            box-shadow: var(--shadow-glow);
            transform: translateY(-2px);
        }

        .search-input {
            width: 100%;
            height: 3.5rem;
            padding: 0 5rem 0 1.5rem;
            border: none;
            border-radius: inherit;
            font-size: 1rem;
            font-weight: 500;
            background: transparent;
            outline: none;
            color: var(--text-primary);
        }
        .search-input::placeholder {
            color: var(--text-light);
        }

        .search-btn {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            width: 2.5rem;
            height: 2.5rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-bounce);
            box-shadow: var(--shadow-sm);
        }
        .search-btn:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: var(--shadow-md);
        }

        /* Enhanced Navigation */
        .nav-links {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            list-style: none;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 600;
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-lg);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
        }
        .nav-link:hover {
            background: var(--bg-tertiary);
            color: var(--primary);
            transform: translateY(-1px);
        }
        .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: var(--shadow-sm);
        }

        /* Enhanced User Actions */
        .user-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: var(--transition-bounce);
            position: relative;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: var(--shadow-sm);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .btn-secondary {
            background: white;
            color: var(--text-primary);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-xs);
        }
        .btn-secondary:hover {
            background: var(--bg-tertiary);
            border-color: var(--border-dark);
            transform: translateY(-1px);
        }

        .badge {
            position: absolute;
            top: -0.5rem;
            right: -0.5rem;
            background: linear-gradient(135deg, var(--error), #dc2626);
            color: white;
            border-radius: var(--radius-full);
            width: 1.25rem;
            height: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Enhanced Hero Section */
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 80vh;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(1deg); }
        }

        .hero-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .hero-content {
            color: white;
        }

        .hero-title {
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, white, rgba(255, 255, 255, 0.8));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: slideInLeft 1s ease-out;
        }

        @keyframes slideInLeft {
            from { transform: translateX(-50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .hero-subtitle {
            font-size: 1.25rem;
            font-weight: 400;
            opacity: 0.9;
            margin-bottom: 2.5rem;
            animation: slideInLeft 1s ease-out 0.2s both;
        }

        .hero-actions {
            display: flex;
            gap: 1rem;
            animation: slideInLeft 1s ease-out 0.4s both;
        }

        .hero-btn {
            padding: 1rem 2rem;
            border-radius: var(--radius-xl);
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition-bounce);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            border: none;
        }

        .hero-btn-primary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }
        .hero-btn-primary:hover {
            background: white;
            color: var(--primary);
            transform: translateY(-4px) scale(1.05);
            box-shadow: var(--shadow-xl);
        }

        .hero-btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }
        .hero-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .hero-visual {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: slideInRight 1s ease-out 0.6s both;
        }

        @keyframes slideInRight {
            from { transform: translateX(50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .hero-graphic {
            width: 100%;
            max-width: 500px;
            height: 400px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: var(--radius-2xl);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .hero-graphic::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shine 3s ease-in-out infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .hero-graphic i {
            font-size: 8rem;
            color: rgba(255, 255, 255, 0.3);
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        /* Enhanced Products Section */
        .products-section {
            padding: 6rem 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .section-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-title {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .section-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Enhanced Filter Panel */
        .filter-panel {
            background: white;
            border-radius: var(--radius-2xl);
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
            transition: var(--transition);
        }
        .filter-panel:hover {
            box-shadow: var(--shadow-xl);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 2rem;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .filter-label {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-input, .filter-select {
            height: 3.5rem;
            padding: 0 1.25rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            font-weight: 500;
            transition: var(--transition);
            background: white;
            color: var(--text-primary);
        }
        .filter-input:focus, .filter-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: var(--shadow-glow);
            transform: translateY(-1px);
        }

        .filter-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            justify-content: center;
        }

        .filter-btn {
            padding: 0.875rem 2rem;
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition-bounce);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.9rem;
        }

        /* Enhanced Category Pills */
        #categoryList {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 1rem 0 2rem;
            margin-bottom: 2rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        #categoryList::-webkit-scrollbar {
            display: none;
        }

        .category-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border-radius: var(--radius-full);
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 600;
            white-space: nowrap;
            transition: var(--transition);
            flex-shrink: 0;
            cursor: pointer;
            border: 2px solid var(--border);
            background: white;
            box-shadow: var(--shadow-xs);
        }
        .category-item:hover {
            background: var(--bg-tertiary);
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }
        .category-item.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-color: var(--primary);
            box-shadow: var(--shadow-glow);
        }

        /* Enhanced Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border);
            transition: var(--transition-slow);
            position: relative;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .product-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-light);
        }

        .product-image-container {
            position: relative;
            overflow: hidden;
            background: var(--bg-tertiary);
        }

        .product-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            transition: var(--transition-slow);
        }
        .product-card:hover .product-image {
            transform: scale(1.1);
        }

        .product-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: var(--shadow-sm);
        }

        .product-content {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-category {
            display: inline-block;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05));
            color: var(--primary);
            padding: 0.375rem 1rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .product-name {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .product-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.5;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .stars {
            color: #fbbf24;
            font-size: 0.9rem;
        }

        .rating-text {
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .product-price {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid var(--border-light);
        }

        .price-current {
            font-size: 1.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .price-original {
            color: var(--text-light);
            text-decoration: line-through;
            font-weight: 500;
        }

        .price-discount {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 700;
            box-shadow: var(--shadow-xs);
        }

        .product-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .add-to-cart {
            flex: 1;
            font-weight: 600;
        }

        /* Enhanced Loading & Empty States */
        .loading-container, .empty-state {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 3rem;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        .empty-state p {
            color: var(--text-light);
        }

        /* Enhanced Carousels */
        .carousel-section {
            padding: 4rem 0;
            background: white;
            border-radius: var(--radius-2xl);
            margin: 3rem 0;
            box-shadow: var(--shadow-lg);
        }

        .carousel-container {
            position: relative;
            overflow: hidden;
            padding: 2rem 0;
        }

        .carousel-track {
            display: flex;
            gap: 1.5rem;
            overflow-x: auto;
            scroll-behavior: smooth;
            padding: 1rem 2rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .carousel-track::-webkit-scrollbar {
            display: none;
        }

        .carousel-card {
            flex: 0 0 280px;
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            transition: var(--transition-bounce);
            cursor: pointer;
            position: relative;
            border: 1px solid var(--border);
        }
        .carousel-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-light);
        }

        .carousel-card .p-image {
            width: 100%;
            height: 160px;
            object-fit: cover;
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
        }

        .p-name {
            font-size: 1rem;
            font-weight: 700;
            min-height: 48px;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .price-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .p-price {
            font-weight: 900;
            font-size: 1.125rem;
            color: var(--primary);
        }

        .p-original {
            text-decoration: line-through;
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .p-discount {
            color: var(--accent);
            font-weight: 700;
            font-size: 0.9rem;
        }

        .rating {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius);
            font-weight: 700;
            font-size: 0.85rem;
            box-shadow: var(--shadow-xs);
        }

        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            cursor: pointer;
            z-index: 2;
            opacity: 0;
            transition: var(--transition-bounce);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            box-shadow: var(--shadow-lg);
        }
        .carousel-container:hover .carousel-btn {
            opacity: 1;
        }
        .carousel-btn:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: var(--shadow-xl);
        }
        .carousel-btn.left {
            left: 1rem;
        }
        .carousel-btn.right {
            right: 1rem;
        }

        /* Enhanced Toast Notifications */
        #toastContainer {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 9999;
            max-width: 400px;
        }

        .toast {
            background: white;
            border-radius: var(--radius-xl);
            padding: 1.25rem 1.5rem;
            box-shadow: var(--shadow-xl);
            border-left: 4px solid var(--success);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: toastSlide 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
        }
        .toast.error {
            border-left-color: var(--error);
        }
        .toast.warning {
            border-left-color: var(--warning);
        }
        .toast.info {
            border-left-color: var(--info);
        }

        .toast-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        .toast.success .toast-icon {
            color: var(--success);
        }
        .toast.error .toast-icon {
            color: var(--error);
        }
        .toast.warning .toast-icon {
            color: var(--warning);
        }
        .toast.info .toast-icon {
            color: var(--info);
        }

        .toast-content {
            font-weight: 600;
            color: var(--text-primary);
        }

        @keyframes toastSlide {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Enhanced Footer */
        .footer {
            background: linear-gradient(135deg, var(--bg-dark), #1e293b);
            color: var(--text-inverse);
            padding: 4rem 0 2rem;
            margin-top: 6rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-section h3 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: white;
            background: linear-gradient(135deg, white, var(--primary-light));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: var(--text-light);
            text-decoration: none;
            transition: var(--transition);
            font-weight: 500;
        }
        .footer-links a:hover {
            color: var(--text-inverse);
            transform: translateX(4px);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 2rem;
            text-align: center;
            color: var(--text-light);
        }

        /* Scroll to top button */
        .scroll-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 3.5rem;
            height: 3.5rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: var(--transition-bounce);
            opacity: 0;
            visibility: hidden;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }
        .scroll-to-top:hover {
            transform: translateY(-4px) scale(1.1);
            box-shadow: var(--shadow-xl);
        }

        /* Quick add animation */
        @keyframes quickAdd {
            0% { transform: scale(1); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        .product-card.adding {
            animation: quickAdd 0.3s ease-in-out;
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 1024px) {
            .hero-container {
                grid-template-columns: 1fr;
                gap: 2rem;
                text-align: center;
            }
            
            .hero-visual {
                order: -1;
            }
            
            .hero-graphic {
                max-width: 300px;
                height: 250px;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .nav {
                gap: 1rem;
            }
            
            .search-container {
                max-width: 300px;
            }
            
            .filter-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .filter-buttons {
                flex-direction: column;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-actions {
                flex-direction: column;
                align-items: center;
                gap: 0.75rem;
            }
            
            .hero-btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1rem;
            }
            
            .carousel-card {
                flex: 0 0 240px;
            }
            
            #toastContainer {
                left: 1rem;
                right: 1rem;
                top: 1rem;
            }
            
            .scroll-to-top {
                bottom: 1rem;
                right: 1rem;
                width: 3rem;
                height: 3rem;
            }
        }

        @media (max-width: 480px) {
            .nav-container {
                padding: 1rem;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .filter-panel {
                padding: 1rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .hero-graphic {
                max-width: 250px;
                height: 200px;
            }
            
            .hero-graphic i {
                font-size: 4rem;
            }
        }

        /* Custom scrollbar for webkit browsers */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: var(--radius);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        }

        /* Focus styles for accessibility */
        .action-btn:focus,
        .filter-btn:focus,
        .hero-btn:focus,
        .search-btn:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .filter-input:focus,
        .filter-select:focus,
        .search-input:focus {
            outline: 2px solid var(--primary);
            outline-offset: -2px;
        }
    </style>
</head>
<body class="page-transition">

    <header class="header" id="header">
        <div class="nav-container">
            <nav class="nav">
                <a href="#" class="logo">
                    <i class="fas fa-rocket"></i> QuickLocal
                </a>
                <div class="search-container">
                    <div class="search-wrapper">
                        <input type="text" class="search-input" placeholder="Search for products, brands, and more..." id="globalSearchInput">
                        <button class="search-btn" id="globalSearchBtn"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                <ul class="nav-links">
                    <li><a href="#" class="nav-link active"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#products" class="nav-link"><i class="fas fa-box"></i> Products</a></li>
                    <li><a href="#" class="nav-link"><i class="fas fa-tags"></i> Deals</a></li>
                </ul>
                <div class="user-actions">
                    <a href="#" class="action-btn btn-secondary"><i class="fas fa-heart"></i> Wishlist</a>
                    <a href="#" class="action-btn btn-secondary"><i class="fas fa-sign-in-alt"></i> Login</a>
                    <a href="#" class="action-btn btn-primary">
                        <i class="fas fa-shopping-cart"></i> Cart
                        <span class="badge" id="cartBadge" style="display: none;">0</span>
                    </a>
                </div>
            </nav>
        </div>
    </header>

    <section class="hero" id="hero">
        <div class="hero-container">
            <div class="hero-content">
                <h1 class="hero-title">Discover Local Excellence</h1>
                <p class="hero-subtitle">Premium products from trusted local vendors, delivered with lightning-fast speed and unmatched quality.</p>
                <div class="hero-actions">
                    <a href="#products" class="hero-btn hero-btn-primary">
                        <i class="fas fa-shopping-bag"></i> Start Shopping
                    </a>
                    <a href="#trending-products" class="hero-btn hero-btn-secondary">
                        <i class="fas fa-fire"></i> View Trending
                    </a>
                </div>
            </div>
            <div class="hero-visual">
                <div class="hero-graphic">
                    <i class="fas fa-store"></i>
                </div>
            </div>
        </div>
    </section>

    <section class="products-section" id="products">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Our Premium Products</h2>
                <p class="section-subtitle">Discover high-quality products from trusted local vendors, curated just for you</p>
            </div>

            <div class="filter-panel">
                <div class="filter-grid">
                    <div class="filter-group">
                        <label for="search-input" class="filter-label">Search Products</label>
                        <input type="text" class="filter-input" placeholder="Search by name, brand, description..." id="search-input">
                    </div>
                    <div class="filter-group">
                        <label for="category-filter" class="filter-label">Category</label>
                        <select class="filter-select" id="category-filter">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="price-filter" class="filter-label">Price Range</label>
                        <select class="filter-select" id="price-filter">
                            <option value="">All Prices</option>
                            <option value="0-500">Under ₹500</option>
                            <option value="500-1000">₹500 - ₹1000</option>
                            <option value="1000-5000">₹1000 - ₹5000</option>
                            <option value="5000+">Above ₹5000</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="sort-select" class="filter-label">Sort By</label>
                        <select class="filter-select" id="sort-select">
                            <option value="name">Name (A-Z)</option>
                            <option value="price-low">Price (Low to High)</option>
                            <option value="price-high">Price (High to Low)</option>
                            <option value="rating">Highest Rated</option>
                        </select>
                    </div>
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn btn-primary" id="applyFilters">
                        <i class="fas fa-filter"></i> Apply Filters
                    </button>
                    <button class="filter-btn btn-secondary" id="clearFilters">
                        <i class="fas fa-times"></i> Clear All
                    </button>
                </div>
            </div>

            <div id="categoryList"></div>

            <div class="products-container">
                <div class="loading-container" id="productsLoading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Loading amazing products...</p>
                </div>
                <div class="products-grid" id="products-container"></div>
                <div class="empty-state" id="emptyState" style="display: none;">
                    <h3><i class="fas fa-search"></i> No Products Found</h3>
                    <p>Try adjusting your search criteria or browse our categories to discover amazing products.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="trending-products" class="carousel-section">
        <div class="container">
            <h2 class="section-title" style="text-align: center; margin-bottom: 2rem;">🔥 Trending Products</h2>
            <div class="carousel-container">
                <button class="carousel-btn left">&#10094;</button>
                <div id="trending-list" class="carousel-track"></div>
                <button class="carousel-btn right">&#10095;</button>
            </div>
        </div>
    </section>

    <section id="recommended-products" class="carousel-section">
        <div class="container">
            <h2 class="section-title" style="text-align: center; margin-bottom: 2rem;">✨ Recommended for You</h2>
            <div class="carousel-container">
                <button class="carousel-btn left">&#10094;</button>
                <div id="recommended-list" class="carousel-track"></div>
                <button class="carousel-btn right">&#10095;</button>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>QuickLocal</h3>
                    <p>Your premium local marketplace connecting you with trusted vendors and high-quality products.</p>
                </div>
                <div class="footer-section">
                    <h3>Shop</h3>
                    <ul class="footer-links">
                        <li><a href="#products">All Products</a></li>
                        <li><a href="#trending-products">Trending</a></li>
                        <li><a href="#">Categories</a></li>
                        <li><a href="#">Deals & Offers</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Account</h3>
                    <ul class="footer-links">
                        <li><a href="#">Login</a></li>
                        <li><a href="#">Register</a></li>
                        <li><a href="#">My Orders</a></li>
                        <li><a href="#">Wishlist</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Support</h3>
                    <ul class="footer-links">
                        <li><a href="#">Help Center</a></li>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">Return Policy</a></li>
                        <li><a href="#">Shipping Info</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 QuickLocal. All rights reserved. Made with ❤️ for local communities.</p>
            </div>
        </div>
    </footer>

    <button class="scroll-to-top" id="scrollToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <div id="toastContainer"></div>

    <script>
        // Enhanced Application State
        const appState = {
            products: [],
            filteredProducts: [],
            categories: new Set(),
            cart: [],
            apiBaseUrl: 'https://quicklocal-backend.onrender.com/api/v1',
            isLoading: false,
            currentFilters: {
                search: '',
                category: '',
                priceRange: '',
                sortBy: 'name'
            }
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('🚀 Initializing Enhanced QuickLocal Marketplace...');
            
            // Initialize components
            initializeEventListeners();
            initializeScrollEffects();
            updateCartUI();
            
            // Load data
            await loadProducts();
            await populateCarousels();
            
            console.log('✅ QuickLocal Marketplace loaded successfully!');
            showToast('Welcome to QuickLocal! Discover amazing local products.', 'success');
        });

        // Enhanced Event Listeners
        function initializeEventListeners() {
            // Filter events
            document.getElementById('applyFilters')?.addEventListener('click', applyAllFilters);
            document.getElementById('clearFilters')?.addEventListener('click', clearAllFilters);
            document.getElementById('categoryList')?.addEventListener('click', handleCategoryPillClick);
            
            // Search events
            const searchInput = document.getElementById('search-input');
            const globalSearchInput = document.getElementById('globalSearchInput');
            
            searchInput?.addEventListener('input', debounce(handleSearchInput, 300));
            globalSearchInput?.addEventListener('input', debounce(handleGlobalSearch, 300));
            
            // Carousel events
            document.querySelectorAll('.carousel-container').forEach(initializeCarousel);
            
            // Header scroll effect
            window.addEventListener('scroll', handleScroll);
            
            // Scroll to top button
            document.getElementById('scrollToTop')?.addEventListener('click', scrollToTop);
        }

        // Enhanced scroll effects
        function initializeScrollEffects() {
            const header = document.getElementById('header');
            const scrollToTopBtn = document.getElementById('scrollToTop');
            
            window.addEventListener('scroll', () => {
                const scrollY = window.scrollY;
                
                // Header effect
                if (scrollY > 100) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
                
                // Scroll to top button
                if (scrollY > 300) {
                    scrollToTopBtn.classList.add('visible');
                } else {
                    scrollToTopBtn.classList.remove('visible');
                }
            });
        }

        // Enhanced product loading with better error handling
        async function loadProducts() {
            if (appState.isLoading) return;
            
            appState.isLoading = true;
            showLoading(true);
            
            try {
                const response = await fetch(`${appState.apiBaseUrl}/products`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Handle different response formats from your backend
                let products = [];
                if (data.success && data.data && Array.isArray(data.data.products)) {
                    // Your backend format: { success: true, data: { products: [...] } }
                    products = data.data.products;
                } else if (data.success && Array.isArray(data.data)) {
                    // Alternative format: { success: true, data: [...] }
                    products = data.data;
                } else if (Array.isArray(data)) {
                    // Direct array format: [...]
                    products = data;
                } else {
                    console.warn('Unexpected API response format:', data);
                    products = [];
                }
                
                // Enhanced product processing
                appState.products = products.map(product => ({
                    ...product,
                    id: product._id || product.id,
                    rating: product.rating || (3.5 + Math.random() * 1.5), // Mock rating if not provided
                    reviews: product.reviews || Math.floor(Math.random() * 500) + 10,
                    originalPrice: product.originalPrice || (product.price * (1 + Math.random() * 0.5)),
                    stock: product.stock !== undefined ? product.stock : Math.floor(Math.random() * 50) + 5
                }));
                
                // Extract categories
                appState.products.forEach(product => {
                    if (product.category) {
                        appState.categories.add(product.category);
                    }
                });
                
                appState.filteredProducts = [...appState.products];
                
            } catch (error) {
                console.error('❌ Failed to load products:', error);
                showToast('Could not load products. Using demo data instead.', 'warning');
                
                // Fallback to demo data
                appState.products = generateDemoProducts();
                appState.filteredProducts = [...appState.products];
                appState.products.forEach(p => appState.categories.add(p.category));
                
            } finally {
                appState.isLoading = false;
                renderAll();
                showLoading(false);
            }
        }

        // Generate demo products for fallback
        function generateDemoProducts() {
            const demoProducts = [
                {
                    id: '1',
                    name: 'Premium Wireless Headphones',
                    description: 'High-quality wireless headphones with noise cancellation and premium sound.',
                    price: 2999,
                    originalPrice: 3999,
                    category: 'Electronics',
                    image: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=300&h=200&fit=crop',
                    rating: 4.5,
                    reviews: 128,
                    stock: 15
                },
                {
                    id: '2',
                    name: 'Organic Green Tea',
                    description: 'Premium organic green tea sourced from local gardens.',
                    price: 599,
                    originalPrice: 799,
                    category: 'Food & Beverages',
                    image: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=300&h=200&fit=crop',
                    rating: 4.8,
                    reviews: 67,
                    stock: 32
                },
                {
                    id: '3',
                    name: 'Designer Cotton T-Shirt',
                    description: 'Comfortable and stylish cotton t-shirt with modern design.',
                    price: 899,
                    originalPrice: 1299,
                    category: 'Clothing',
                    image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=300&h=200&fit=crop',
                    rating: 4.2,
                    reviews: 89,
                    stock: 24
                },
                {
                    id: '4',
                    name: 'Smart Fitness Tracker',
                    description: 'Advanced fitness tracker with heart rate monitoring and GPS.',
                    price: 4999,
                    originalPrice: 6999,
                    category: 'Electronics',
                    image: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=300&h=200&fit=crop',
                    rating: 4.6,
                    reviews: 203,
                    stock: 8
                },
                {
                    id: '5',
                    name: 'Artisan Coffee Beans',
                    description: 'Freshly roasted artisan coffee beans from local roasters.',
                    price: 1299,
                    originalPrice: 1599,
                    category: 'Food & Beverages',
                    image: 'https://images.unsplash.com/photo-1559056199-641a0ac8b55e?w=300&h=200&fit=crop',
                    rating: 4.7,
                    reviews: 156,
                    stock: 45
                },
                {
                    id: '6',
                    name: 'Leather Messenger Bag',
                    description: 'Handcrafted leather messenger bag perfect for work and travel.',
                    price: 3499,
                    originalPrice: 4999,
                    category: 'Fashion',
                    image: 'https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=300&h=200&fit=crop',
                    rating: 4.4,
                    reviews: 78,
                    stock: 12
                }
            ];
            
            return demoProducts;
        }

        // Enhanced rendering functions
        function renderAll() {
            renderCategories();
            renderProducts();
            updateCartUI();
        }

        function renderProducts() {
            const container = document.getElementById('products-container');
            const emptyState = document.getElementById('emptyState');
            
            if (!container) return;

            if (appState.filteredProducts.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'flex';
                return;
            }
            
            emptyState.style.display = 'none';

            container.innerHTML = appState.filteredProducts.map(product => {
                const discount = product.originalPrice ? 
                    Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100) : 0;
                
                const stars = generateStars(product.rating);
                
                return `
                    <div class="product-card" data-product-id="${product.id}">
                        <div class="product-image-container">
                            <img loading="lazy" src="${product.image || 'https://via.placeholder.com/300x220'}" 
                                 alt="${product.name}" class="product-image">
                            ${discount > 0 ? `<div class="product-badge">${discount}% OFF</div>` : ''}
                        </div>
                        <div class="product-content">
                            <div class="product-category">${product.category}</div>
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-description">${product.description || ''}</p>
                            <div class="product-rating">
                                <div class="stars">${stars}</div>
                                <span class="rating-text">(${product.reviews || 0} reviews)</span>
                            </div>
                            <div class="product-price">
                                <span class="price-current">₹${product.price.toLocaleString()}</span>
                                ${product.originalPrice ? 
                                    `<span class="price-original">₹${product.originalPrice.toLocaleString()}</span>` : ''}
                                ${discount > 0 ? `<span class="price-discount">${discount}% OFF</span>` : ''}
                            </div>
                            <div class="product-actions">
                                <button class="action-btn btn-primary add-to-cart" 
                                        onclick="handleAddToCart('${product.id}')" 
                                        ${product.stock === 0 ? 'disabled' : ''}>
                                    <i class="fas fa-shopping-cart"></i> 
                                    ${product.stock === 0 ? 'Out of Stock' : 'Add to Cart'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderCategories() {
            const catListContainer = document.getElementById('categoryList');
            const catFilterSelect = document.getElementById('category-filter');

            if (!catListContainer || !catFilterSelect) return;

            const allPill = `<div class="category-item active" data-category="">🏪 All Products</div>`;
            const categoryIcons = {
                'Electronics': '📱',
                'Clothing': '👕',
                'Food & Beverages': '🍵',
                'Fashion': '👜',
                'Home & Garden': '🏠',
                'Sports': '⚽',
                'Books': '📚'
            };
            
            const categoryPills = [...appState.categories].map(cat => 
                `<div class="category-item" data-category="${cat}">
                    ${categoryIcons[cat] || '🏷️'} ${cat}
                </div>`).join('');
            
            catListContainer.innerHTML = allPill + categoryPills;

            catFilterSelect.innerHTML = '<option value="">All Categories</option>' + 
                [...appState.categories].map(cat => `<option value="${cat}">${cat}</option>`).join('');
        }

        // Enhanced carousel functionality
        async function populateCarousels() {
            await populateCarousel('trending-list', getTrendingProducts());
            await populateCarousel('recommended-list', getRecommendedProducts());
        }

        function getTrendingProducts() {
            return appState.products
                .sort((a, b) => (b.rating * b.reviews) - (a.rating * a.reviews))
                .slice(0, 8);
        }

        function getRecommendedProducts() {
            return appState.products
                .filter(p => p.rating >= 4.0)
                .sort(() => Math.random() - 0.5)
                .slice(0, 8);
        }

        async function populateCarousel(elementId, products) {
            const list = document.getElementById(elementId);
            if (!list || !products.length) return;

            list.innerHTML = products.map(product => createCarouselCard(product)).join('');
        }

        function createCarouselCard(product) {
            const discount = product.originalPrice ? 
                Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100) : 0;
            
            return `
                <div class="carousel-card" onclick="handleCardClick('${product.id}')">
                    <img class="p-image" loading="lazy" 
                         src="${product.image || 'https://via.placeholder.com/280x160'}" 
                         alt="${product.name}">
                    <div class="p-name">${product.name}</div>
                    <div class="price-row">
                        <div class="p-price">₹${product.price.toLocaleString()}</div>
                        ${product.originalPrice ? 
                            `<div class="p-original">₹${product.originalPrice.toLocaleString()}</div>` : ""}
                        ${discount > 0 ? `<div class="p-discount">${discount}% OFF</div>` : ""}
                    </div>
                    <div class="rating">${product.rating.toFixed(1)} ⭐</div>
                </div>
            `;
        }

        function initializeCarousel(container) {
            const track = container.querySelector('.carousel-track');
            const leftBtn = container.querySelector('.carousel-btn.left');
            const rightBtn = container.querySelector('.carousel-btn.right');
            
            leftBtn?.addEventListener('click', () => scrollCarousel(track, -1));
            rightBtn?.addEventListener('click', () => scrollCarousel(track, 1));
        }

        function scrollCarousel(track, direction) {
            if (!track) return;
            
            const cardWidth = track.querySelector('.carousel-card')?.offsetWidth || 280;
            const scrollAmount = (cardWidth + 24) * 2; // Scroll 2 cards at a time
            
            track.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }

        // Enhanced event handlers
        function handleAddToCart(productId) {
            const product = appState.products.find(p => p.id === productId);
            if (!product) return;

            // Add animation to product card
            const productCard = document.querySelector(`[data-product-id="${productId}"]`);
            productCard?.classList.add('adding');
            setTimeout(() => productCard?.classList.remove('adding'), 300);

            const existingItem = appState.cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity++;
                showToast(`Updated ${product.name} quantity in cart!`, 'info');
            } else {
                appState.cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: 1
                });
                showToast(`${product.name} added to cart!`, 'success');
            }
            
            updateCartUI();
        }

        function handleCategoryPillClick(e) {
            const pill = e.target.closest('.category-item');
            if (!pill) return;

            document.querySelectorAll('#categoryList .category-item').forEach(p => 
                p.classList.remove('active'));
            pill.classList.add('active');
            
            document.getElementById('category-filter').value = pill.dataset.category;
            appState.currentFilters.category = pill.dataset.category;
            
            applyAllFilters();
        }

        function handleCardClick(productId) {
            showToast(`Opening product details for ${productId}...`, 'info');
            // Future: Navigate to product detail page
        }

        function handleSearchInput(e) {
            appState.currentFilters.search = e.target.value.toLowerCase();
            applyAllFilters();
        }

        function handleGlobalSearch(e) {
            const searchTerm = e.target.value;
            document.getElementById('search-input').value = searchTerm;
            handleSearchInput(e);
            
            if (searchTerm) {
                document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function handleScroll() {
            const scrollY = window.scrollY;
            
            // Parallax effect for hero section
            const hero = document.getElementById('hero');
            if (hero) {
                hero.style.transform = `translateY(${scrollY * 0.5}px)`;
            }
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Enhanced filtering with better performance
        function applyAllFilters() {
            const filters = {
                search: document.getElementById('search-input').value.toLowerCase(),
                category: document.getElementById('category-filter').value,
                priceRange: document.getElementById('price-filter').value,
                sortBy: document.getElementById('sort-select').value
            };

            let filtered = [...appState.products];

            // Apply search filter
            if (filters.search) {
                filtered = filtered.filter(product => 
                    product.name.toLowerCase().includes(filters.search) ||
                    product.description?.toLowerCase().includes(filters.search) ||
                    product.category.toLowerCase().includes(filters.search)
                );
            }

            // Apply category filter
            if (filters.category) {
                filtered = filtered.filter(product => product.category === filters.category);
            }

            // Apply price range filter
            if (filters.priceRange) {
                if (filters.priceRange === '5000+') {
                    filtered = filtered.filter(product => product.price >= 5000);
                } else {
                    const [min, max] = filters.priceRange.split('-').map(Number);
                    filtered = filtered.filter(product => 
                        product.price >= min && product.price <= max);
                }
            }

            // Apply sorting
            switch (filters.sortBy) {
                case 'price-low':
                    filtered.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    filtered.sort((a, b) => b.price - a.price);
                    break;
                case 'rating':
                    filtered.sort((a, b) => b.rating - a.rating);
                    break;
                case 'name':
                default:
                    filtered.sort((a, b) => a.name.localeCompare(b.name));
                    break;
            }

            appState.filteredProducts = filtered;
            appState.currentFilters = filters;
            renderProducts();

            // Show filter results message
            const resultCount = filtered.length;
            const totalCount = appState.products.length;
            
            if (resultCount < totalCount) {
                showToast(`Found ${resultCount} products matching your criteria`, 'info');
            }
        }

        function clearAllFilters() {
            // Reset form inputs
            document.getElementById('search-input').value = '';
            document.getElementById('category-filter').value = '';
            document.getElementById('price-filter').value = '';
            document.getElementById('sort-select').value = 'name';
            
            // Reset global search
            document.getElementById('globalSearchInput').value = '';
            
            // Reset category pills
            document.querySelectorAll('#categoryList .category-item').forEach(p => 
                p.classList.remove('active'));
            document.querySelector('#categoryList .category-item[data-category=""]')?.classList.add('active');
            
            // Reset state and re-render
            appState.filteredProducts = [...appState.products];
            appState.currentFilters = { search: '', category: '', priceRange: '', sortBy: 'name' };
            renderProducts();
            
            showToast('All filters cleared!', 'success');
        }

        // Enhanced UI functions
        function showLoading(isLoading) {
            const loadingContainer = document.getElementById('productsLoading');
            const productsContainer = document.getElementById('products-container');
            
            if (loadingContainer && productsContainer) {
                loadingContainer.style.display = isLoading ? 'flex' : 'none';
                productsContainer.style.display = isLoading ? 'none' : 'grid';
            }
        }

        function updateCartUI() {
            const cartBadge = document.getElementById('cartBadge');
            const totalItems = appState.cart.reduce((sum, item) => sum + item.quantity, 0);
            
            if (totalItems > 0) {
                cartBadge.textContent = totalItems > 99 ? '99+' : totalItems;
                cartBadge.style.display = 'flex';
            } else {
                cartBadge.style.display = 'none';
            }
        }

        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let stars = '';
            for (let i = 0; i < fullStars; i++) stars += '<i class="fas fa-star"></i>';
            if (hasHalfStar) stars += '<i class="fas fa-star-half-alt"></i>';
            for (let i = 0; i < emptyStars; i++) stars += '<i class="far fa-star"></i>';
            
            return stars;
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            if (!container) return;
            
            const toast = document.createElement('div');
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                warning: 'fa-exclamation-triangle',
                info: 'fa-info-circle'
            };
            
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <i class="fas ${icons[type]} toast-icon"></i>
                <div class="toast-content">${message}</div>
            `;
            
            container.appendChild(toast);
            
            // Auto remove after 4 seconds
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 4000);
            
            // Remove on click
            toast.addEventListener('click', () => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            });
        }

        // Utility functions
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Make functions globally accessible
        window.handleAddToCart = handleAddToCart;
        window.handleCardClick = handleCardClick;

        // Add some keyboard shortcuts for better UX
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + K to focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                document.getElementById('globalSearchInput').focus();
            }
            
            // Escape to clear search
            if (e.key === 'Escape') {
                const searchInput = document.getElementById('globalSearchInput');
                if (searchInput === document.activeElement) {
                    searchInput.blur();
                    clearAllFilters();
                }
            }
        });

        // Add intersection observer for animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe product cards for animation
        setTimeout(() => {
            document.querySelectorAll('.product-card').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(card);
            });
        }, 100);
<script type="module" src="js/marketplace.js"></script>
<script type="module" src="js/simple-api.js"></script>
<script type="module" src="js/global-search.js"></script>
    </script>
</body>
</html>